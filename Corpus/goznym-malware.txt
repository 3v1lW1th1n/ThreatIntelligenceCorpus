Our Insight

Malevolence
Graphs
Templates


Our Initiatives

Bogon Reference
Darknet Project
IP to ASN Mapping
Malware Hash Registry
Open Resolver Challenge
Flow Sonar
TC Console
CSIRT Assistance Program
BATTLE
BIN Feed
#totalhash
IXP Service
UTRS


Who We Are

Our Insight

Malevolence
Graphs
Templates



Malevolence
Graphs
Templates

Malevolence
Graphs
Templates
Our Initiatives

Bogon Reference
Darknet Project
IP to ASN Mapping
Malware Hash Registry
Open Resolver Challenge
Flow Sonar
TC Console
CSIRT Assistance Program
BATTLE
BIN Feed
#totalhash
IXP Service
UTRS



Bogon Reference
Darknet Project
IP to ASN Mapping
Malware Hash Registry
Open Resolver Challenge
Flow Sonar
TC Console
CSIRT Assistance Program
BATTLE
BIN Feed
#totalhash
IXP Service
UTRS

Bogon Reference
Darknet Project
IP to ASN Mapping
Malware Hash Registry
Open Resolver Challenge
Flow Sonar
TC Console
CSIRT Assistance Program
BATTLE
BIN Feed
#totalhash
IXP Service
UTRS
Who We Are






Dragon News
An inside look at the world of Team Cymru. Cybersecurity tools, tips, news and views.
Categories
Archives
Tags
Our Insight

Malevolence
Graphs
Templates


Our Initiatives

Bogon Reference
Darknet Project
IP to ASN Mapping
Malware Hash Registry
Open Resolver Challenge
Flow Sonar
TC Console
CSIRT Assistance Program
BATTLE
BIN Feed
#totalhash
IXP Service
UTRS


Who We Are

Our Insight

Malevolence
Graphs
Templates



Malevolence
Graphs
Templates

Malevolence
Graphs
Templates
Our Initiatives

Bogon Reference
Darknet Project
IP to ASN Mapping
Malware Hash Registry
Open Resolver Challenge
Flow Sonar
TC Console
CSIRT Assistance Program
BATTLE
BIN Feed
#totalhash
IXP Service
UTRS



Bogon Reference
Darknet Project
IP to ASN Mapping
Malware Hash Registry
Open Resolver Challenge
Flow Sonar
TC Console
CSIRT Assistance Program
BATTLE
BIN Feed
#totalhash
IXP Service
UTRS

Bogon Reference
Darknet Project
IP to ASN Mapping
Malware Hash Registry
Open Resolver Challenge
Flow Sonar
TC Console
CSIRT Assistance Program
BATTLE
BIN Feed
#totalhash
IXP Service
UTRS
Who We Are
 © 2018 Team Cymru, Inc. –  Insight that improves and saves lives..
Our Insight

Malevolence
Graphs
Templates


Our Initiatives

Bogon Reference
Darknet Project
IP to ASN Mapping
Malware Hash Registry
Open Resolver Challenge
Flow Sonar
TC Console
CSIRT Assistance Program
BATTLE
BIN Feed
#totalhash
IXP Service
UTRS


Who We Are

Our Insight

Malevolence
Graphs
Templates



Malevolence
Graphs
Templates

Malevolence
Graphs
Templates
Our Initiatives

Bogon Reference
Darknet Project
IP to ASN Mapping
Malware Hash Registry
Open Resolver Challenge
Flow Sonar
TC Console
CSIRT Assistance Program
BATTLE
BIN Feed
#totalhash
IXP Service
UTRS



Bogon Reference
Darknet Project
IP to ASN Mapping
Malware Hash Registry
Open Resolver Challenge
Flow Sonar
TC Console
CSIRT Assistance Program
BATTLE
BIN Feed
#totalhash
IXP Service
UTRS

Bogon Reference
Darknet Project
IP to ASN Mapping
Malware Hash Registry
Open Resolver Challenge
Flow Sonar
TC Console
CSIRT Assistance Program
BATTLE
BIN Feed
#totalhash
IXP Service
UTRS
Who We Are







Threats 10 Min Read
2nd May 2016 

Threats
10 Min Read
2nd May 2016 
GOZNYM MALWARE
ARTICLE OVERVIEW

Antivirus software detects GozNym hybrid as Nymaim variant
GozNym samples resolve domains, do not connect to IPs returned. Separate IP used for
HTTP comms.
C2 channel for GozNym appears to be HTTP POST requests, in line with Nymaim-based
origins
Recent active related C2s at 194.149.138.49, 54.186.122.88, 82.13.46.90, 168.235.72.204 and
domain ytugctbfm[.]com used
IP85.171.195.89 likely C2 for late March/early April 2016 campaign
Late March/early April 2016 campaign appears to primarily target US, AT, DE
Campaigns are time-limited and samples will not run if system clock is outside a pre-set
date range

Antivirus software detects GozNym hybrid as Nymaim variant
GozNym samples resolve domains, do not connect to IPs returned. Separate IP used for
HTTP comms.
C2 channel for GozNym appears to be HTTP POST requests, in line with Nymaim-based
origins
Recent active related C2s at 194.149.138.49, 54.186.122.88, 82.13.46.90, 168.235.72.204 and
domain ytugctbfm[.]com used
IP85.171.195.89 likely C2 for late March/early April 2016 campaign
Late March/early April 2016 campaign appears to primarily target US, AT, DE
Campaigns are time-limited and samples will not run if system clock is outside a pre-set
date range
Recent reports have indicated the emergence of a hybrid of the Nymaim loader malware and the Gozi financial Trojan, dubbed ‘GozNym’. This report analysis hashes associated with GozNym and identifies associated samples, domains and IPs.
Open sources provide a number of hashes of malware samples claimed to be GozNym. These are shown below.
Table 1- Open source GozNym MD5s
As of 18 April 2016, there is no specific ‘GozNym’ signature provided by any antivirus vendor, with most vendors detecting the above samples as Nymaim variants. Similar to Nymaim, GozNym samples and campaigns appear to be time-limited: i.e. samples will not run outside of a predefined date range.
Note: as a result of this behaviour, this report references a number of historic sandbox runs from early April 2016 to present.
Sample 2a90…0245 (identified by IBM) is detected by Microsoft as ‘TrojanDownloader:Win32/Nymaim’ and Ikarus as ‘Trojan-Banker.Gozi’. At the time of writing, this is the only sample recorded displaying these attributes.
In a PCAP obtained from VirusTotal, dating from 6 April 2016, sample c5ab4…5274 (identified by IBM1) was observed to resolve the domain ‘kcrznhnlpw[.]com’ and make an HTTP POST request to ‘85.171.195.89/zdf3nb6i/index.php’. The header of this POST request is shown below.
Figure 1 – GozNym/Nymaim HTTP POST request header
This HTTP POST activity is in-line with behaviour previously associated with Nymaim.
The DNS query response for ‘kcrznhnlpw[.]com’ in the session analysed provided four IP addresses:
Table 2 – DNSRRs for ‘kcrznhnlpw[.]com’ (6 April 2016)
Note that the POST request ostensibly made to ‘kcrznhnlpw[.]com’ shown above in Figure 1 was sent to 85.171.195.89 (AS21502 – ASN-NUMERICABLE NC Numericable S.A., FR), not one of the addresses in Table 2.
The reason for this behaviour is unclear, although it may imply that a form of transform is being applied to the IPs returned in the DNS response.
Searching for samples which perform DNS queries for ‘kcrznhnlpw[.]com’ returns two additional samples:
Table 3 – Malware samples querying ‘kcrznhnlpw[.]com’
Sample 47bd2478feb9cb0c08f7e716c94cc8c8 was sandboxed on 8 April 2016, at which point in time the DNS record for ‘kcrznhnlpw[.]com’ had been modified (see Table 4 below).
Table 4 – DNSRRs for ‘kcrznhnlpw[.]com’ (8 April 2016)
This may suggest a change in infrastructure around this time period.
The implications of the target IP used for the HTTP POST requests not changing, despite a change in the returned DNSRRs, are unclear. While it may suggest that the DNSRRs are used for something other than a ‘transform’ into the target IP, it may simply mean that the IP transformed into 85.171.195.89 is one of the three to remain unchanged.
This sample then made HTTP POST requests to the IP addresses shown in Table 5. At the time, both of these addresses were responsive and returned data.
Table 5 – HTTP POST target IPs for 47bd2478feb9cb0c08f7e716c94cc8c8
Searching based on 85.171.195.89 – the common destination IP for the HTTP POST requests – reveals one additional sample, also identified by antivirus products as Nymaim.
Table 6 – Malware samples with flows to 85.171.195.89
The lack of specific antivirus signatures for GozNym coupled with many of its behaviour characteristics being akin to those of Nymaim are significant limiting factors when attempting to differentiate the malware from ‘standard’ Nymaim/Gozi samples.
Passive DNS results identified other domains that have historically resolved to the same IP addresses listed in table 4. These domains showed similar random letter pattern as visible in Table 7.

Table 7 – PDNS matrix for ‘kcrznhnlpw[.]com’ IPs



Table 8 – Registration & DNS details for domains associated with ‘kcrznhnlpw[.]com’ IPs


The results shown in Table 8 suggest that there are currently at least three active controllers associated with this campaign. Note that the three domains with associated DNS records as of 20 April 2016 return the same four IP addresses and appear to have been registered on the same day as one of the other associated domains was ‘updated’.
Two malware samples (Table 9) were identified resolving the domain ‘ytugctbfm[.]com’. In line with previously recorded Nymaim/GozNym behaviour, these samples were observed making HTTP POST requests to ‘/ub3w5stq/index.php’ on the IPs in Table 10 and Table 11. All four of these IPs were responsive and returned data.

Table 9 – Malware samples querying ‘ytugctbfm[.]com’


Table 10 – HTTP POST target IPs for 44d09eac8cf488000fb8ab3585789b5b
Table 11 – HTTP POST target IPs for 2cd713ad63b5d9fe53000f2362d85fc9
Of the domains which appear inactive as of the time of writing, three malware samples were identified resolving the domain ‘ykyru[.]com’ and one resolving the domain ‘humzka[.]com’. The details of these samples are listed in Table 12.
Table 12 – Malware samples contacting domains from Table 7
The samples associated with ‘ykyru[.]com’ were identified by antivirus products as Nymaim, while the sample associated with ‘humzka[.]com’ was identified as DDoS:Win32/Nitol.D (Microsoft) or Backdoor.Win32.Androm.jjha (Kaspersky).
PCAP results for samples 57944…ea73 and 1ba77…bb1c generated similar HTTP POST requests directed towards mis-matched IP/domain combinations. Table 13 and Table 14 show the DNSRR entries for ‘ykyru[.]com’ and ‘humzka[.]com’, respectively.
Table 13 – DNSRRs for ‘ykyru[.]com’ (24 March 2016)
Table 14 – DNSRRs for ‘humzka[.]com’ (31 March 2016)
Communications with Command and Control (C2) Servers on 80/TCP can potentially provide insight into victim distribution for this campaign. Summary data is shown below, with Figure 2 showing the top twenty country codes affected and Figure 3 the top twenty ASes, both calculated by the number of unique IPs observed.
Figure 2 – Top 20 country codes contacting C2 on 80/TCP (by unique IP)
Figure 3 – Top 20 ASes contacting C2 on 80/TCP (by unique IP)
It should be noted that the IPs recorded contacting C2 on 80/TCP appear to be predominantly consumer broadband connections likely using dynamic IP allocation. As such, the numbers above should be treated as indicative only.

Share:





Share:





patrick



















Share

Share
