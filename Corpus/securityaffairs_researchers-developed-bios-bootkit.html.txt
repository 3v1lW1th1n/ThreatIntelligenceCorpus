
					Researchers developed a new powerful BIOS Bootkit that exploits BIOS flaws					
BIOS bootkits are a reality despite there is little evidence of BIOS implants in the wild. The BIOS bootkits was mentioned when Snowden disclosed the catalog of surveillance tools used by the NSA ANT division, these malicious malware are able to compromise the BIOS of the victim’s machine ensuring persistence and implementing sophisticated evasion techniques.  The BIOS implant survives even is the OS is re-installed. Recently experts at Kaspersky Lab discovered that a sophisticated APT, The Equation Group,  used BIOS bootkits to compromise a targeted machine, due the complexity of the malicious implants many security experts speculated a direct link betweeen the hacking crew and the NSA.
Both NSA and the Equation Group (the hacking crew used is in both EquationDrug and GrayFish platforms) referred the module NLS_933W.DLL which is widely used by principal vendors. The nls_933w.dll contains a driver that drops the malware, the driver implemented by attackers allows the interaction with the hard drive from the kernel level, as explained the experts at Kaspersky.
“It’s not that the code that was so sophisticated; it used certain sequences of ATA commands to interact with the hard drive, but the sophisticated part was not exposed. It was the [reprogrammed] firmware itself,” said Vitaly Kamluk, principal security researcher with Kaspersky Lab “To master writing the firmware, it takes years to do that. We just saw that the level of sophistication is high because of what they’re capable of doing, but we don’t have the firmware itself.” “This is an ultimate persistence mechanism, and it has the ultimate resilience to removal. This is a next level of persistence never seen before,” continues Kamluk “This is unique and the first time we’ve seen that level of complexity from an advanced actor.”
Today at the CanSecWest conference in Vancouver, the researchers Corey Kallenberg and Xeno Kovah founders of startup LegbaCore, will present their research on a new set of BIOS vulnerabilities and the results of their work on the development of a working BIOS rootkits.
The researchers have discovered a method to bypass BIOS protection mechanism, but the most interesting aspect of the research is that the experts have defined a method to automate the discovery of vulnerabilities.

The hack is feasible under specific conditions, the attacker would need to have remote access to the target machine to implant the BIOS bootkit, allowing him to elevate privileges on the machine through the hardware.
How does the BIO bootkit works?
The exploit designed by the researchers disables the BIOS defense mechanisms, which prevent the firmware re-flashing, and inject and execute the malicious code.
The most scaring aspect of the BIOS bootkit developed by Kallenberg and Kovah is that the implant is injected into System Management Mode that is a computer operating mode in which all normal execution, including the operating system, is suspended and special separate software, including the firmware.is executed with high privileges.
The researchers exploited the System Management Mode to run their BIOS bootkit with high privileges and manage various components of the targeted architecture including the memory. The researchers highlighted that also secure distro like Tails could be targeted by the implant, the BIOS bootkit could be used to steal sensitive data and also the secret PGP key used by the popular OS.
“The idea is that if the OS is compromised by an implant, it’s OK to use Tails for communication (all Internet connections are made through the Tor browser) because it’s shielded from the malware that hit the main operating system,” Kallenberg said. “What the implant does is it waits for Tails to boot and scrapes sensitive data out of memory and exfiltrates it out. Our agent listens in the background, Tails doesn’t see it.”
“We store data in a non-volatile area and it’s not erased,” explained Kallenberg. “The idea is to make it obvious that these secure boot disk style things are architecturally vulnerable to attackers who come at you from the BIOS level space.”
The implant works on BIOS variants of many vendors and according to the expert, the BIOS bootkit is effective also against UEFI, that is considered the evolution of the BIOS.
Let’s wait for more material of the presentation.
Pierluigi Paganini
(Security Affairs – BIOS bootkit, malware)
