
					Android malware uses Google Cloud Messaging Service as C&C Server					
Android malware exploits the Google Cloud Messaging Service (GCM) as Command and Control server. The Google service allows Android app developers to send messages using JSON format to installed apps, but hackers exploited it for malicious purposes. The discovery has been made by researchers at Kaspersky with a post on Securelist.
The JSON format is commonly used by developers to structure their data within a container, it is very versatile and commonly used by many applications. The Kaspersky Lab researchers have detected at least five different Android trojans that used JSON format:
The authors of the malware in every case took advantage of Google Cloud Messaging Service  to exchange messages between C&C services and the malicious app. Once gained a Google Cloud Messaging Service (GCM) ID, malware updates are distributed exploiting directly the Google cloud services and also any command to the malicious agent is sent exploiting the service and using JSON format. The Google Cloud Messaging Service (GCM) acts as Command and Control server for the Trojans, what is very smart in this implementation is that malware updates appear to the user to be official updates via Google.
“Furthermore, the execution of commands received from Google Cloud Messaging Service GCM is performed by the GCM system and it is impossible to block them directly on an infected device. The only way to cut this channel off from virus writers is to block developer accounts with IDs linked to the registration of malicious programs.”
SMS.AndroidOS.FakeInst.a is the most diffused agent, according Kaspersky experts more than 4,800,000 installers have been detected and around 160000 attempted installation were blocked in 2012.
“It can send text messages to premium numbers, delete incoming text messages, generate shortcuts to malicious sites, and display notifications advertising other malicious programs that are spread under the guise of useful applications or games” states the Kaspersky blog post.
SMS.AndroidOS.Agent.ao is presented as a porn app and has the primary intent to send messages to premium numbers meanwhile the SMS.AndroidOS.OpFake.a malware is the typical SMS malicious application of which have been detected also more than 1 million installers. This last malware is also able to steal sensitive information from the victim’s handset such as  contacts and it is also able to self-update its code, the agent appeared very active and was detected in 97 different countries, the majority in Russia and eastern countries. The Kaspersky team has blocked more than 60,000 attempted installs, it sends several commands from both the GCM and its own C&C servers such as:
Backdoor.AndroidOS.Maxit trojan was very dated, first instance was detected in late 2011 and appears to be continuously updated, today the experts counted more than 40 different variants most often in Malaysia, Thailand, the Philippines and Burma.
“All of these modifications are very similar to one another,” “the app opens websites with games, while malicious operations are executed in the background.” It has been found most often in Malaysia, but also in Thailand, the Philippines and Burma.

“The first thing the backdoor sets out to do is collect information about the phone and the SIM card, including the phone number and the mobile provider. All of this data is uploaded to the androidproject.imaxter.net C&C. This is the server that manages all of the Trojan’s primary functions.”
The last trojan, SMS.AndroidOS.Agent.az., was detected for the first time in May 2012 and is a shell app for a Vietnamese porn website which is able also to send text messages to a premium number.
The number of malware that exploit the Google Cloud Messaging Service is destined to increase despite it is still relatively low, the data on their diffusion demonstrated it. These malware are prevalent in Western Europe, the CIS, and Asia, virus writers know very well that execution of commands received from GCM is performed by the Google Cloud Messaging Service system and it is impossible to block them directly on an infected device.
Actually the only option for security experts is to block developer accounts with IDs linked to the registration of malicious applications.
Pierluigi Paganini
(Security Affairs  Google Cloud Messaging Service, Android, malware)
