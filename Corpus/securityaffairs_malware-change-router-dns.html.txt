
					A Brazilian newspaper site used in server malware to change Router DNS Settings					
A Brazilian political newspaper’s website has been compromised with malware that tries to change the victim’s router DNS settings.
The security firm Securi has published a blog post on a recent attack against a Brazilian political newspaper whose website was compromised to serve a malware that tries to change the victim’s router DNS settings. The Politica Estadao’s website was loading iFrames that runs a brute-force attack against the victim’s home router’s admin credentials.
“These iFrames were trying to change the DNS configuration on the victim’s DSL router by Brute Forcing the admin credentials.” states the post.

The malware tries a combination of known default credentials to access the admin console of the routers.
“The payload was trying the user admin, root, gvt and a few other usersnames, all using the router default passwords,” said researcher Fioravante Souza.
IFrame based attacks are a consolidated hacking practice in the cybercrime ecosystem, once infected a host could be recruited as part of a botnet to conduct DDoS attacks or could be used to serve a malware. Last year cyber security expert Dancho Danchev discovered an iFramed based traffic E-shops and the offer of access to hijacked legitimate traffic to be later on converted to malware-infected hosts.
There are numerous methods for monetizing managing a portion of hijacked Web traffic, through of blackhat SEO (search engine optimization), DNS cache poisoning, RFI (Remote File Inclusion) or spam/phishing campaigns tactics traffic is sold and resold to achieve criminals purposes.
In this specific case the bad actors use to change DNS osettings of routers to redirect traffic.
The hidden iFrame injection loads content from a second website, laspeores[]com[.ar.], also this website is compromised and run an iFrame attack which load and pull content from a URL shortening service vv2[.]com. A third iFrame is used in the attack chain to loads, using a malicious JavaScript, that redirects to a third website.
“The script is being used to identify the local IP address of your computer said,” Souza said. “It then starts guessing the router IP by passing it as a variable to another script.”
“This script is being used to identify the local IP address of your computer. It then starts guessing the router IP by passing it as a variable to another script:
http ://cect .ut .ee/wordpress/wp-content/js/?ip=172.16.102.128".
It is publicly available on the internet, there’s nothing malicious on it. You can find a similar function on http://net.ipcalf.com/.” states the post.
This is not the first time that routers of Brazilian users are targeted by cyber criminals, recently experts at Kaspersky spotted an interesting attack from Brazilian cyber gangs that try to change the DNS settings of home routers by using a web-based attack.
Threat actors try to exploit poorly configured routers (e.g. Use of default password) for illegal activities.
I suggest the reading of an excellent report published by Team Cymru that revealed a detailed report on a large scale SOHO pharming attack that hit more that 300,000 devices worldwide, another similar attacks was conducted against a number of banks in Polands to steal credentials for online banking services.
Improve security of SOHO devices is a must to avoid serious consequences.
Pierluigi Paganini
(Security Affairs – Routers hacking, SOHO)
