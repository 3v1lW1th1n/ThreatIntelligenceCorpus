APT28 Using EternalBlue to Attack Hotels in Europe, Middle East
Russian-speaking cyberespionage group APT28, also known as Sofacy, is believed to be behind a series of attacks last month against travelers staying in hotels in Europe and the Middle East. APT28 notably used the NSA hacking tool EternalBlue as part of its scheme to steal credentials from business travelers, according to a report released Friday by security firm FireEye.
One of the goals of the attack is to trick guests to download a malicious document masquerading as a hotel reservation form that, if opened and macros are enabled, installs a dropper file that ultimately downloads malware called Gamefish. Gamefish establishes a foothold in targeted systems as a way to install the open source tool called Responder, according to FireEye.
“Once inside the network of a hospitality company, APT28 sought out machines that controlled both guest and internal Wi-Fi networks,” wrote authors of the report Lindsay Smith and Benjamin Read, both researchers with FireEye’s cyber espionage team.
“To spread through the hospitality company’s network, APT28 used a version of the EternalBlue SMB exploit. This was combined with the heavy use of py2exe to compile Python scripts. This is the first time we have seen APT28 incorporate this exploit into their intrusions,” researchers said.
FireEye said APT28’s objective was to steal credentials from business travelers using hotel Wi-Fi networks, which the researchers said they did not observe. FireEye does cite a 2016 hotel attack by APT28 with a similar modus operandi. In that incident, a hotel guest’s username and password were stolen while they used the Wi-Fi network. Within 12 hours the victim’s business network was compromised by someone using their credentials.
Once the foothold is established in the hotel’s wi-fi system, hackers deployed the Responder tool in order to facilitate NetBIOS Name Service (NBT-NS) poisoning. “This technique listens for NBT-NS (UDP/137) broadcasts from victim computers attempting to connect to network resources. Once received, Responder masquerades as the sought-out resource and causes the victim computer to send the username and hashed password to the attacker-controlled machine,” researchers said.
That username and hashed password from hotel guests is cracked offline and later used to escalate privileges in the victim’s network, according to FireEye.
In all, hotels in seven European countries and one Middle Eastern country were targeted. “Business and government personnel who are traveling, especially in a foreign country, often rely on systems to conduct business other than those at their home office, and may be unfamiliar with threats posed while abroad,” researchers wrote.
APT28, or Sofacy, is the group implicated by a December DHS report related to U.S. election hacks. In a report released earlier this week, Kaspersky Lab said the group has adopted new macro techniques and continued to find new targets such as the French political party.
“These incidents show a novel infection vector being used by APT28. The group is leveraging less secure hotel Wi-Fi networks to steal credentials and a NetBIOS Name Service poisoning utility to escalate privileges,” FireEye wrote. “Publicly accessible Wi-Fi networks present a significant threat and should be avoided whenever possible.”
