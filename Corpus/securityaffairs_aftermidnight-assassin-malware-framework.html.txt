
					Vault7 – Wikileaks published documentation for AfterMidnight and Assassin  malware					
While critical infrastructure worldwide and private organizations were ridiculed by the WannaCry attack, WikiLeaks released a new batch of CIA documents from the Vault 7 leaks.
The new dump included the documentation related to two CIA frameworks used to create custom malware for Microsoft Windows platform.
The two frameworks are codenamed AfterMidnight and Assassin, both malware implements classic backdoor features that allowed the CIA to take control over the targeted systems.
Since March, WikiLeaks obtained thousands of files allegedly originating from a network of the U.S. Central Intelligence Agency (CIA). In a post I have published on the Infosec Institute I have summarized what has happened in the last weeks and what has been disclosed by the organization.
Below the list of previous batches published by Wikileaks:
According to WikiLeaks, the AfterMidnight malware framework allows CIA operators to dynamically load and execute malicious payload on a target system.
The principal payload is disguised as a self-persisting Windows Dynamic-Link Library (DLL) file and executes small payloads dubbed “Gremlins” that are able to subvert the functionality of targeted software, gather target’s information, or providing services for other gremlins.
“‘Gremlin’ is the term for an AM payload that is meant to run hidden on target and either:

The documents include the AfterMidnight user guide, below the description provided by the manual for the malware platform:
“AfterMidnight is a DLL that self-persists as a Windows Service DLL and provides secure execution of “Gremlins” via a HTTPS based LP. Once installed on a target machine AM will call back to a configured LP on a configurable schedule, checking to see if there is a new plan for it to execute.” reads the user guide.”If there is, it downloads and stores all needed components before loading all new gremlins in memory. All local storage is encrypted with an “LP” key that is not stored on the client. If AM is unable to contact the LP it will be unable to execute any payload.”
The local storage used by the AfterMidnight is encrypted with a key which is not stored on the target machine.
CIA operators can schedule a custom task using a custom script language included in a special module “AlphaGremlin.”
The second Malware Framework, so-called Assassin, is described with the following statement by Wikipedia.
“”Assassin” is a similar kind of malware; it is an automated implant that provides a simple collection platform on remote computers running the Microsoft Windows operating system. Once the tool is installed on the target, the implant is run within a Windows service process. “Assassin” (just like “AfterMidnight”) will then periodically beacon to its configured listening post(s) to request tasking and deliver results.” states WikiLeaks. “Communication occurs over one or more transport protocols as configured before or during deployment. The “Assassin” C2 (Command and Control) and LP (Listening Post) subsystems are referred to collectively as” The Gibson” and allow operators to perform specific tasks on an infected target.”
Once infected a target machine, Assassin runs the implant within a Windows service process to allow CIA operators to perform malicious tasks.
According to the user guide, the four components of the Assassin malware framework are:
Stay Tuned…
Pierluigi Paganini
(Security Affairs – AfterMidnight malware platform, hacking)
