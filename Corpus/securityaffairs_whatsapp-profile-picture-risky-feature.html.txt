
					WhatsApp profile picture: a risky feature? In the mind of a hacker					
When you add a random phone number to your contact list, WhatsApp will show you the profile picture of that user. Given the fact that you don’t know that person, there shouldn’t be any inherent risk with that feature. Am I right?
If you think that I am, please read the following story.
Selling a used television
Imagine that you are browsing a classified ads site, and you come up with an ad in which someone called Bob is selling a nice 52″ smart TV, with little use and ready to have a new owner by just $1,000. The ad includes a phone number, that can be used to contact Bob in order to get further information or close the deal.
At this time, we have got very interesting information about our victim. He is Bob, we know his phone number, where he is based, and that he’ll be expecting people contacting him about his used TV.
Right, this has just started.
Facebook time
It’s time to know who Bob is.
The first step is to add his phone number to our contact list: this way, his nice picture will pop up. Now, with the name, the picture and the city where he lives, we can quickly find his Facebook profile by performing a couple of searches and going through the results.
Yes, we found him.
The public profile doesn’t say much about him, but it’s adding one additional detail: where he studied. That is more than enough to get access to his private profile. We create one fake profile appearing to be someone that studied in the same college and withing the same time period. Wouldn’t you be accepting a friend request that might be an old mate?
Bob does.

Getting into the circle of trust
Now we have access to Bob’s friends list, which means that we can have a pretty good understanding of his social and professional environment.
We quickly discover that he works for a consumer business corporation as Assistant Manager in the Accounting department. Sounds interesting, but let’s leave it there for now.
Please notice that, beyond professional details, his circle of trust also becomes readily available to us. This circle might include best friends, relatives, professional mates, and perhaps some old friends with whom he hasn’t been in contact for a long time.
We are interested in the latter group. How can we find that particular profile? Easy task. Just browse Bob’s news feed, and see who hasn’t been really active with regards to his posts in the last few months. Or perhaps find that guy that just reply from time to time with messages promising to meet at the earliest opportunity.
Yeah, this guy will be very helpful.
Guess why?
Yes, you are right, that old friend will not be friendly anymore.
Impersonating an old friend
As you might have guessed, it’s the time to impersonate John, who is the one looking to fit in our target profile. We just have to pick up some random details about his relationship with Bob, in order to build a credible message when we impersonate him.
What are our weapons? References to past events, other friends, news that might be relevant to Bob, topics he is interested in, products or brands Bob likes, and the like.
We notice that Bob loves roller-coasters. That sounds like a plan: we’ll be sending him a link to a news article describing an accident occurred in one of the most popular roller-coasters in the US.
But the goal is to build a message that Bob will believe to be coming from John. Obviously, it will be coming from us instead. How can we manage to do that then?
Ok, here is the thing: John has changed his phone number since last time he met Bob. However, Bob will trust that he is talking to John for three reasons: we know things that only someone in his circle of trust could know (what he likes), we have his telephone number (from the ad) and, more importantly, Bob will see John’s profile picture when he reads our WhatsApp message.
Where we got that profile picture from? Yeah, you are right, we downloaded from Bob’s Facebook friends list.
The final stage
Bob will receive a WhatsApp message containing a link referencing relevant news for him from a trusted source.
What would you do if you were Bob’s? I would bet that you’d check it out. The malicious link will trigger a drive-by download that will infect his mobile phone. The malware will be unique, designed for this particular attack, so the antivirus will go unnoticed.
We got it. Now we have access to his e-mails, files and contacts, thus rendering private information readily available for us. And what value has that information? Bob is just someone selling a used TV.
But Bob is more than that. He is an Assistant Manager in the Accounting department of a corporation, so getting access to his mobile phone gives us access to confidential data that he will be exchanging with dozens of collagues every day.
What’s next?
What would you do now? Research e-mails? Download attachments? Trying to browse corporate websites?
I’ll tell you what I would do.
I would send a message from his account to his most frequent contacts. The message would include a malicious link. And most of the recipients would click on it.
Guess why? Yeah, you are right. You have now become Bob.
And the game starts again.
Lessons learned
Bob’s adventure is becoming a frequent story as advanced attacks become more targetted, persistent and sophisticated.
The following lessons can be learnt from it:
Rafael San MiguelSenior Manager – Strategic Alliances – EMEA
 
Pierluigi Paganini
Security Affairs –  (WhatsApp, FireEye)
