
					The ImageMagick flaw is being exploited in the wild					
The security researcher John Graham-Cumming from CloudFlare asserts that his firm recently discovered a critical vulnerability, code named CVE-2016-3714, in the popular image manipulation software, ImageMagick.
The flaw could be exploited by hackers to take over websites running the widely used image-enhancing app. The vulnerability in ImageMagick App allows attackers to run arbitrary code on the targeted web servers that rely on the app for resizing or cropping user-uploaded images.
CloudFlare has updated its Web application firewall to prevent attackers exploit the flaw in an attempt to protect its customers who have not patched their websites.
In a blog post published on May 9th , 2016, John Graham-Cumming explained that the flaw is being triggered in the wild for reconnaissance.
“We began watching the exploitation of CVE-2016-3714 as soon as the WAF rule went live across our network,”. He went further to say, “the bad news is that this vulnerability is being actively used by hackers to attack websites’’ and that “all these payloads are designed to give the hacker unrestricted access to the vulnerable Web server such that with a single exploit they can gain remote access and then proceed to further hack the vulnerable Web server at their leisure.” reads the post.

Graham-Cumming also revealed that the most common payload used in the attacks contains the following snippet that is harmless but that may have been using to verify is the target is vulnerable.
Another type of payload introduced in the post allows the attacker to download a file from a remote server he controls directly on the vulnerable server.
“The attacker downloads a file (presumably from a server they control) using wget and saves it to a file on the website’s server. This could be the prelude to a larger attack and the contents of the temporary file would likely contain a program to be executed on the web server giving the attacker access.” continues the post.
Over the weekend, researchers observed a much more dangerous payload that downloads a python program called x.py from a server the attack controls, saves it as/tmp/x.py and then executes it.
“This downloads a python program called x.py from a server the attack controls, saves it as/tmp/x.py and then executes it. The parameters to the program are the IP address and port of a machine to contact. The python code connects to that machine and makes a shell available on the web server to the attacker. At that point the attacker can interact directly with the web server.”
The researchers from the Sucuri firm confirmed to have spotted cyberattackers attempting to install reverse shells on vulnerable servers.
“We’ve been actively monitoring this vulnerability, and have discovered a few different attacks targeting it. Interestingly enough, the attacks themselves seem to be aimed at specific customers as opposed to mass blanket attacks, which is what you’d expect when these type of serious and easy to exploit vulnerabilities are disclosed.” states Sucuri.
One of the exploits creates a reverse shell to 106.186.30.XX that is an IP registered on Linode, a virtual private server provider alleged used by attackers.  The real HTTP requests used in the cyber attack has origin from a server with a Taiwanese IP address.
Administrators of servers which deploy the ImageMagick app directly or indirectly must ensure they upgrade them as quickly as possible.
“At the current time we do not know of a website that has been successfully hacked using ImageTragick, but it is clear that hackers are actively trying this vulnerability as it is fresh and many servers are likely to not have been patched yet.” concludes CloudFlare.
Written by: Don Okereke
Author Bio: Don Okereke is a seasoned, technology and social media-savvy security consultant, ex-serviceman, voracious reader, writer, blogger and public speaker with nearly 20 years combined experience distilled from Nigeria and the United Kingdom. Don is passionate about cybersecurity, open-source intelligence, researching, gathering, disseminating information and rendering altruistic service to humanity. He is the publisher/editor-in-chief of www.donokereke.blogspot.com through which he disseminates cutting-edge security, safety, threat alerts, and passionately advocates against violent extremism and crime.
Follow Don on Twitter: @donokereke
Pierluigi Paganini
(Security Affairs – ImageMagick, hacking)
