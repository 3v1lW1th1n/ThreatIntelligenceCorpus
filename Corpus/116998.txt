Fileless PowerWare Ransomware Found on Healthcare Network
Attackers are not through testing the limits of what they can do with new features in ransomware samples.
That latest found in the wild is called PowerWare and it was discovered a week ago targeting a company in the healthcare industry, researchers at Carbon Black told Threatpost.
What sets PowerWare apart from other crypto-ransomware samples is that it is fileless, which is a tactic adopted by other malware families pushed in prolific exploit kits such as Angler. Palo Alto Networks, for example, disclosed on March 11 a malware family called PowerSniff that has similar behaviors to PowerWare, including fileless infections.
PowerWare is spreading in spam campaigns, the email messages containing a Word document attachment purporting to be an invoice. In order to properly render the attachment, the victim is enticed to enable macros. Once enabled, the macro opens cmd.exe, which then calls PowerShell, a native Windows framework that uses a command-line shell to manage tasks, to download a malicious script. The use of PowerShell avoids writing files to the disk and allows the malware to blend in with legitimate activity on the computer, said Rico Valdez, senior threat intelligence researcher at Carbon Black.
“The macros are there to launch PowerShell and pull down the ransomware script. Lots of malware can be distributed via macros in Word docs. Most of the time they download additional binaries to do more bad stuff (backdoors, etc.),” Valdez said. “This does not pull down any additional binaries (executables), and leverages PowerShell (already on the system and approved to be there) to do the dirty work.”
Valdez said that PowerWare uses PowerShell to ultimately encrypt files stored on the machine once it’s compromised.
“The program that actually does all the encrypting of the files is PowerShell. A script is downloaded and fed to PowerShell,” Valdez said. “This means no ‘traditional’ malware – no additional executable needed – just a text document (script).”
The victim’s files are encrypted and a $500 ransom is demanded in exchange for the encryption key; the ransom, however, goes up to $1,000 two weeks after infection, Valdez said.
The use of macros to initiate the ransomware download is not exclusive to PowerWare. Locky, for example, which has already infected hospitals in Hollywood and Kentucky, used a similar means of propagation, relying on spam emails laced with Word docs using macros to download the malware. Locky, however, uses the macros to download files to the compromised machine, something that PowerWare avoids.
The use of macros to push malware, meanwhile, has enjoyed a resurgence in the last six months, not only with ransomware, but also banking malware such as Dridex. Macros, however, are disabled by default on Windows machines.
“The attack aims to social engineer the end user into enabling macros. Many Word docs and Excel spreadsheets include macros, so this may not be too unusual, depending on the target environment and sophistication of the user,” Valdez said.
As for PowerSniff, discovered by Palo Alto, it uses macros to initiate a PowerShell instance which then downloads shellcode that writes the Ursnif point-of-sale malware directly into memory.
Both companies have published indicators of compromise for the respective malware families.
