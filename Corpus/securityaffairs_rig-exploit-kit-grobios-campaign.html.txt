
					Experts noticed an ongoing activity involving the RIG Exploit Kit to deliver the Grobios Trojan					
Anyway, researchers at FireEye periodically observe significant developments in this space and recently noticed an interesting ongoing activity involving the infamous RIG Exploit Kit (EK).
The RIG Exploit Kit has been recently involved in the distribution of the Grobios Trojan, in the following image is reported the infection chain.

“We first observed redirects to RIG EK on Mar. 10, 2018, from the compromised domain, latorre[.]com[.]au, which had a malicious iframe injected to it.” reads the analysis published by FireEye. 
“The iframe loads a malvertisement domain, which communicates over SSL and leads to the RIG EK landing page that loads the malicious Flash file”. “When opened, the Flash file drops the Grobios Trojan.”
Malware researchers said the Grobios Trojan implements several evasion techniques and uses various persistence mechanisms to make hard for victims to uninstall the threat. The malware implements the following techniques to gain persistence:
The malware also uses multiple anti-debugging, anti-analysis and anti-VM techniques to evade the detection.
Once completed a series of checks to detect the VM and malware analysis environment, the Grobios Trojan connects to the command and control (C2) server to receive commands.
“In an effort to evade static detection, the authors have packed the sample with PECompact 2.xx.” continues the analysis. 
“The unpacked sample has no function entries in the import table. It uses API hashing to obfuscate the names of API functions it calls and parses the PE header of the DLL files to match the name of a function to its hash.  The malware also uses stack strings.”
Once infected the system, the malware also creates two scheduled tasks.
Experts highlighted that the malware protects its copy in the %TEMP% folder with (Windows Encrypted File System) EFS.
The analysis of the code also revealed the presence of two hardcoded obfuscated C2s.
“Despite the decline in activity, exploit kits still continue to put users at risk – especially those running older versions of software. Enterprises need to make sure their network nodes are fully patched.” concluded FireEye.
Further details including the IoCs for the threat are available in the report.
Pierluigi Paganini
(Security Affairs – RIG Exploit Kit , Grobios Trojan)
