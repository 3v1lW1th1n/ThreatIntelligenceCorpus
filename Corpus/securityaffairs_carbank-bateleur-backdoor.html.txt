
					The bateleur backdoor is the new weapon in the Carbank gang’s arsenal					
According to researchers at security firm Proofpoint, the infamous cyber crime gang cyber crime gang Carbanak has added a new JScript backdoor dubbed Bateleur Backdoor to its arsenal. Carbanak, aka Carbanak, aka FIN7, has also used updated macros.
The Carbanak gang was first discovered by Kaspersky Lab in 2015. the group has stolen at least $300 million from 100 financial institutions.the group has stolen at least $300 million from 100 financial institutions.
In early 2016, the Carbanak gang target banks and financial institutions, mainly in the US and the Middle East.target banks and financial institutions, mainly in the US and the Middle East.
In November last year, experts at Trustwave uncovered a new campaign launched by the group targeting organizations in the hospitality sector.
In January, the Carbanak gang started using Google services for command and control (C&C) communication.
The crooks used the “ggldr” script to send and receive commands to and from Google Apps Script, Google Sheets, and Google Forms services.ggldr” script to send and receive commands to and from Google Apps Script, Google Sheets, and Google Forms services.
Hackers used to create a unique Google Sheets spreadsheet for each infected user, in this way they attempted to avoid detection.
In May, researchers at Trustwave observed the group using new social engineering techniques and phishing techniques, including the use of hidden shortcut files (LNK files) for target compromise.
Back to the present, the group started using new macros and the Bateleur backdoor in attacks against United States-based chain restaurants.United States-based chain restaurants.
“Proofpoint researchers have uncovered that the threat actor commonly referred to as FIN7 has added a new JScript backdoor called Bateleur and updated macros to its toolkit. We have observed these new tools being used to target U.S.-based chain restaurants, although FIN7 has previously targeted hospitality organizations, retailers, merchant services, suppliers and others.” ” reads the analysis published by Proofpoint. The new macros and Bateleur backdoor use sophisticated anti-analysis and sandbox evasion techniques as they attempt to cloak their activities and expand their victim pool.”
The Carbanak gang started using macro documents to drop the new JScript backdoor instead GGLDR script that was used in past campaigns to send and receive commands to and from Google Apps Script, Google Sheets, and Google Forms services.
Experts noticed that the Carbanak gang has updated multiple times both the macro and the malware since June.
Attackers used simple and effective messages to target a restaurant chain, if email is sent from an Outlook.com account then the text claims “This document is encrypted by Outlook Protect Service,”if it is sent by a Gmail account, the lure document instead claims “This document is encrypted by Google Documents Protect Service.”email is sent from an Outlook.com account then the text claims “This document is encrypted by Outlook Protect Service,”if it is sent by a Gmail account, the lure document instead claims “This document is encrypted by Google Documents Protect Service.”

The documents embed macros that access the malicious payload via a caption, then they extracts the JScript from the caption and save the content to documents embed macros that access the malicious payload via a caption, then they extracts the JScript from the caption and save the content to documents embed macros that access the malicious payload via a caption, then they extracts the JScript from the caption and save the content to documents embed macros that access the malicious payload via a caption, then they extracts the JScript from the caption and save the content to debug.txt in the current user’s temporary folder (%TMP%). Next, the macro creates a scheduled task to execute debug.txt as a JScript (the Bateleur backdoor), it sleeps for 10 seconds before deleting the scheduled task
The Bateleur backdoor appears very sophisticated, it implements anti-sandbox and anti-analysis (obfuscation) mechanisms.
“The malicious JScript has robust capabilities that include anti-sandbox functionality, anti-analysis (obfuscation), retrieval of infected system information, listing of running processes, execution of  custom commands and PowerShell scripts, loading of EXEs and DLLs, taking screenshots, uninstalling and updating itself, and possibly the ability to exfiltrate passwords, although the latter requires an additional module from the command and control server (C&C).” continues the analysis.
“Although Bateleur has a much smaller footprint than GGLDR/HALFBAKED, lacks basic features such as encoding in the C&C protocol, and does not have backup C&C servers, we expect the Bateleur developer(s) may add those features in the near future,” the security researchers say.
Proofpoint speculates the Bateleur backdoor is being used by the FIN7/Carbanak group, the researchers observed a threat actor that was using this specific code along with GGLDR scripts that was used exclusively by the gang.
The phishing messages were “sharing very similar or identical attachment names, subject lines, and/or sender addresses.”
The Bateleur backdoor was also leveraging the Tinymet Meterpreter downloader, a tool employed by Carbanak hackers since 2016.
“A small Meterpreter downloader script, called Tinymet by the actor(s) (possibly inspired by [5]), has repeatedly been observed being utilized by this group at least as far back as 2016 [6] as a Stage 2 payload. In at least one instance, we observed Bateleur downloading the same Tinymet Meterpreter downloader ” states Proofpoint.downloader ” states Proofpoint.downloader script, called Tinymet by the actor(s) (possibly inspired by [5]), has repeatedly been observed being utilized by this group at least as far back as 2016 [6] as a Stage 2 payload. In at least one instance, we observed Bateleur downloading the same Tinymet Meterpreter downloader ” states Proofpoint.downloading the same Tinymet Meterpreter downloader ” states Proofpoint.downloading the same Tinymet Meterpreter downloader ” states Proofpoint.downloading the same Tinymet Meterpreter downloader ” states Proofpoint.
The Carbanak is still active and continuously improve its Tactics, Techniques, and Procedures.Carbanak is still active and continuously improve its Tactics, Techniques, and Procedures.Carbanak is still active and continuously improve its Tactics, Techniques, and Procedures.Carbanak is still active and continuously improve its Tactics, Techniques, and Procedures.
“We continue to see regular changes to the tactics and tools used by FIN7 in their attempt to infect more targets and evade detection. The Bateleur JScript backdoor and new macro-laden documents appear to be the latest in the group’s expanding toolset, providing new means of infection, additional ways of hiding their activity, and growing capabilities for stealing information and executing commands directly on victim machines,” ProofPoint concludes.
Pierluigi Paganini
(Security Affairs –  cybercrime, Carbanak cybergang)
adrotate banner=”5″]
