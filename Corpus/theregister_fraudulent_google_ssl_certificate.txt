Fraudulent Google credential found in the wild
Security researchers have discovered a counterfeit web certificate for Google.com circulating on the internet that gives attackers the encryption keys needed to impersonate Gmail and virtually every other digitally signed Google property.
The forged certificate was issued on July 10 to digitally sign Google pages protected by SSL, or secure sockets layer. It was issued by DigiNotar, a certificate authority located in the Netherlands. The forged certificate is valid for *.google.com, giving its unknown holders the means to mount transparent attacks on a wide range of Google users who access pages on networks controlled by the counterfeiters.
It's at least the second time in five months that unauthorized parties have gotten hold of valid SSL certificates used to cryptographically prove that a sensitive website is authentic rather than a forgery. In March, hackers broke into the servers of a web-authentication authority and minted valid certificates for Google Mail and six other domains. It took eight days for the counterfeit credentials to be fully blocked from all major browsers, and much longer to be blacklisted from email programs.
The episode exposed serious vulnerabilities in the net's foundation of trust, because in the intervening time it was possible for attackers to create convincing forgeries of trusted services that were almost impossible for people on attacker-controlled networks to detect. The hack was carried out on a reseller of certificate authority Comodo, and came from servers that used an Iranian IP address. Monday's attack appeared to be more of the same.
“This isn't a huge surprise,” Moxie Marlinspike, a researcher and frequent critic of the SSL system said on Monday about the discovery of the latest Google certificate forgery. “This is the kind of thing we should expect is happening all the time. The only thing noteworthy is that anyone noticed.”
Google and Mozilla have responded to the forgery by preparing updates to Chrome, Firefox and other software programs that take the highly unusual step of blocking all certificates issued by DigiNotar while the forgery is being investigated.
According to a post published on Sunday by a user calling himself alibo, the counterfeit certificate surfaced when he tried to log into his Gmail account using the Google Chrome browser.
“I think my ISP or my government did this attack (because I live in Iran and you may hear something about the story of Comodo hacker!)” he wrote.
Alibo's claims that Iranian ISPs including ParsOnline were using the certificate to validate Gmail couldn't be independently confirmed. But the document he published has been verified by researchers as a valid certificate issued on July 10 by DigiNotar that digitally signs all URLs that end in Google.com.
“This CA should receive an internet death sentence as their carelessness may have resulted in deaths in Iran,” an unknown researcher who verified the certificate wrote. “This cert was issued in JULY of 2011 and it is now just a few days before SEPTEMBER. It is being used in the wild against real people in Iran *right* now.”
Indeed, statements issued by Google and Mozilla shortly after this article was first published indicate a growing mistrust of DigiNotar, which in January was acquired by VASCO Data Security, a maker of two-factor tokens and other authentication products.
“While we investigate, we plan to block any sites whose certificates were signed by DigiNotar,” a statement issued by Google announced.
Google credited a security feature recently added to its Chromium browser engine with protecting alibo and bringing the bogus credential to public attention.
Mozilla, meanwhile, said it planned to issue updates for Firefox, Thunderbird and SeaMonkey shortly “that will revoke trust in the DigiNotar root and protect users from this attack.” It invited users who don't want to wait to manually purge the DigiNotar root from their browsers following these instructions.
Representatives from DigiNotar didn't respond to repeated requests for comment.
Marlinspike has recently proposed a new system he calls Convergence for authenticating websites. It allows end users to query parties they trust when validating the SSL certificates provided by websites they encounter. The system, which is enabled through an add-on for Firefox, is designed to eliminate reliance on certificate authorities, which aren't legally or financially accountable to end users and have suffered a variety of security breaches over the years.
Someone relying on Convergence wouldn't have been tricked by the rogue certificate discovered Monday.
“Whoever got this cert seems to have had it since July 10th, almost 40 days!” Melih Abdulhayoglu, CEO of Comodo wrote in an email. “Maybe they already had a good use out of it would be one guess I have. I find it difficult to believe that this is for notoriety, as if it was, then they would publish it immediately after obtaining it.”
Abdulhayoglu said the certificate was revoked on Monday, but that status may not do much to stop any attacks in progress. As Marlinspike demonstrated in 2009, it's trivial for attackers to suppress the error messages returned by revoked certificates, allowing rogue certificates to live on for weeks or months after they are discovered. The only foolproof way to revoke a certificate is to update each browser, email client, and other piece of software accepting SSL certificates to blacklist the counterfeit credential.
That means the certificate could be a threat until patches are issued by all software makers that work with SSL certificates. It's unclear how long that will take.
If it's true that this credential is being used to snoop on Gmail users, there's no telling how long it will take to stop the attack. ®

This post was updated to include comment from Google and Mozilla.


Sponsored: 
Following Bottomline’s journey to the Hybrid Cloud

