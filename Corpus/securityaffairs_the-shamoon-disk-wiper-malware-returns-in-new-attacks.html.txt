
					The dreaded Shamoon Wiper is back in a new attack					
Do you remember the Shamoon malware?
Shamoon, also known as Disttrack, was first spotted in a wave of attacks that targeted companies in Saudi Arabia in 2012. Among the victims, there was the petrol giant Saudi Aramco. The principal capability of Shamoon is a feature that allows it to wipe data from hard drives of the infected systems.
In the attack against Saudi Aramco Shamoon wipe data on over 30,000 computers and rewrite the hard drive MBR (Master Boot Record) with an image of a burning US flag.
The first team that discovered the malware was Kaspersky Lab that had analyzed some instances of the threat linked to the “wiper agent” due to the presence of a module of a string with a name that includes “wiper” as part of it.
The researcher of Seculert who analyzed Shamoon discovered that it has also the ability to overwrite the machine’s MBR. Before Shamoon makes unusable the infected PC, it gathers data from the victim, it steals information, taking data from the ‘Users’, ‘Documents and Settings’, and ‘System32/Drivers’ and ‘System32/Config’ folders on Windows computers, and send them to another infected PC on the same internal network.
The malware was developed to destroy target systems, making the machine unusable. The malware was able to infect several OSs, including Windows 95, Windows 98, Windows XP, Windows 200, Windows Vista, Windows NT, Windows ME, Windows 7, Windows Server 2003, and Windows Server 2008.
Now the threat is back, security experts detected it in a new wave of attacks. Experts from Palo Alto Networks and Symantec reported an attack a single Saudi company.
“Why Shamoon has suddenly returned again after four years is unknown. However, with its highly destructive payload, it is clear that the attackers want their targets to sit up and take notice,” reported Symantec.
“Last week, Unit 42 came across new Disttrack samples that appear to have been used in an updated attack campaign. The attack targeted at least one organization in Saudi Arabia, which aligns with the targeting of the initial Shamoon attacks. It appears the purpose of the new Disttrack samples were solely focused on destruction, as the samples were configured with a non-operational C2 server to report to and were set to begin wiping data exactly on 2016/11/17 20:45. In another similarity to Shamoon, this is the end of the work week in Saudi Arabia (their work week is from Sunday to Thursdays), so the malware had potentially the entire weekend to spread.  The Shamoon attacks took place on Lailat al Qadr, the holiest night of the year for Muslims; another time the attackers could be reasonably certain employees would not be at work.” reads an analysis published by Palo Alto Networks.
The new variant of Shamoon detected by the experts is able to rewrite the MBR on affected computers with an image of a three-year-old Syrian boy named Alan Kurdi that lay dead on a Turkish beach.
According to Symantec, this is a carefully planned operation. The malware was configured with passwords that appear to have been stolen from the targeted organizations. Attackers used these credentials to rapidly spread the threat across the targeted organization’s network. It is still unclear how the attackers obtained the credentials.
The malware comes with a default configuration, it launched the disk-wiping component at 8:45pm local time on Thursday, November 17. Considering that in Saudi Arabia the working week runs from Sunday to Thursday, the attacker tried to exploit the pause in order to maximize the effects of the attack.
“The malware had a default configuration that triggered the disk-wiping payload at 8:45pm local time on Thursday, November 17. The Saudi Arabian working week runs from Sunday to Thursday. It would appear that the attack was timed to occur after most staff had gone home for the weekend in the hope of reducing the chance of discovery before maximum damage could be caused.” wrote Symantec.
The attack was planned to start on Laylat al Qadr (Night of Decree) that is a Muslim holiday.

The analysis of the malware revealed that is was almost identical to the one used in the 2012 attacks.
Its infrastructure is composed of three components, a dropper, a wiper, and a module for communications that assured the attackers to remotely control the malware.
In the recent attack, the component for the remote communications was configured with the IP 1.1.1.1, that didn’t host the Shamoon C&C server. This circumstance suggests that attackers plan did not include the possibility of changing the treat.
According to PaloAlto Networks, from a functionality standpoint, the wiper is powered by EldoS RawDisk driver utility that is able to overwrite files on the system without any interaction with the OS.
Experts believe that the group behind this last attack is the responsible for the 2012 hack too, for example, the researchers noticed that the EldoS RawDisk driver altered the infected host’s system time to August 2012, just a day before the expiration date for the driver’s temporary license. The license was the same used in the 2012 attacks.
“The current attack campaign has several TTP overlaps with the original Shamoon campaign, especially from a targeting and timing perspective. Also, Disttrack malware used in the recent attacks is very similar to the variant used in the 2012 attacks, which uses the exact same RawDisk device driver as well (down to the same, temporary license key).. The main purpose of the Disttrack malware is to overwrite files and storage partitions in an attempt to destroy data and render the system unusable. To maximize its destruction, the Disttrack tool attempts to spread to other systems on the network using stolen administrator credentials, which suggests that the threat actors had previous access to the network or carried out successful phishing attacks prior to the attack using Disttrack.”states PaloAlto Networks.
Give a look at the report that includes also IoC for the last Shamoon attack.
Pierluigi Paganini
(Security Affairs – Shamoon, malware)
