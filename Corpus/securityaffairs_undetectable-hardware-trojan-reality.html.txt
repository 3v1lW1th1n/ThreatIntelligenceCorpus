
					An undetectable Hardware Trojan is reality					
A Team of researchers conducted a study on a stealthy Dopant-Level Hardware Trojans, an insidious menace that could have a dramatic impact on production processed of chips in every sector.
The team composed by researchers Georg T. Becker, Francesco Ragazzoni, Christof Paar and Wayne P. Burleson described in a paper how it is possible to conduct a hardware-based attack introducing in legitimate circuits a hardware trojan not detectable.
“In this paper we propose an extremely stealthy approach for implementing hardware Trojans below the gate level, and we evaluate their impact on the security of the target device. Instead of adding additional circuitry to the target design, we insert our hardware Trojans by changing the dopant polarity of existing transistors.” states the paper abstract.
The exploitation of a hardware backdoor for cyber espionage purpose has always been the subject of heated debate, intelligence experts have accused in the past Chinese companies to have the ability to remotely access to the communication equipments sold in the United States and Western Countries thanks this kind of attacks.
The possibility to infiltrate a supply chain with a hardware trojan is a target for any governments, the repercussion could be critical considering the penetration of technology in military and commercial sectors.
Since now security community has focused its researches on the designing of a hardware Trojan through modification in motherboard circuitry or wiring, practically various works conducted since now are based on the introduction of malware at the hardware layer. This technique could be ineffective in those environments where in implementing a careful process of hardware qualification, another factor to consider is that an attacker would have access to layout masks and of course additional space for insertion of malicious circuits that would be easy to detect.
Last Snowden’s revelations on the NSA surveillance activities evidenced the effort spent by US intelligence with major chipmakers for the introduction of backdoors into hardware sold to foreign targets.
The team described in the paper the process to modify a circuit introducing a hardware trojan able to elude detection mechanisms, the backdoor is implemented changing the dopant polarity of existing transistors instead introducing supplementary hardware.
“Since the modified circuit appears legitimate on all wiring layers (including all metal and polysilicon), our family of Trojans is resistant to most detection techniques, including fine-grain optical inspection and checking against ‘golden chips,’” states the study. 
Modifying the conductive behaviors of  electrical components adding dopant elements the researchers were able to insert their stealthy hardware Trojan on Intel’s random number generator design used in Ivy Bridge processors, as well as in a side-channel resistant SBox implementation.

The paper details how compromise the Intel Ivy Bridge processors pulling off a side channel attack that leaked secret keys from the hardware.
The document describes the main idea of the proposed design of the hardware Trojan:
“A gate of the original design is modied by applying a dierent dopant polarity to specic parts of the gate’s active area. These modications change the behavior of the target gate in a predictable way and are very similar to the technique used for code-obfuscation in some commercial designs”
The results are surprising, the backdoor is not detectable and raise serious questions on hardware qualification and delocalizzation of production in places where cost of the supply chain are cheap.
“Even if chips are manufactured in a trusted [fabrication], there is the risk that chips with hardware Trojans could be introduced into the supply chain,” the researchers wrote. “The discovery of counterfeit chips in industrial and military products over the last years has made this threat much more conceivable.”
Differently from past researchers conducted by Research Community isn’t manipulated the concentration of dopant element but its polarity, an operation that anyway need to be done at a foundry setting and is undetected to optical inspection.
The approach described in the paper is able to elude Hardware Trojan detection mechanisms into post-manufacturing and pre-manufacturing detection mechanisms, in  reality the detection is possible but not practicable due the large volume of devices belonging a production.
“A dedicated setup could eventually allow one to identify the dopant polarity. However, doing so in a large design comprising millions of transistors implemented with small technologies seems impractical and represents an interesting future research direction,” the paper said. “We exploit this limitation to make our Trojans resistant against optical reverse-engineering.”
In the attack of the Ivy Bridge,  researchers were able to get their Trojan onto the processor at the sub-transistor level:
“Our Trojan is capable of reducing the security of the produced random number from 128 bits to n bits, where n can be chosen,” “Despite these changes, the modified Trojan RNG passes not only the Built-In-Self-Test (BIST) but also generates random numbers that pass the NIST test suite for random numbers.”
Concluding this post it is fundamental to raise once again the debate on the importance of hardware qualification, governments have to develop the ability to manage every aspect of production processes and arrange an efficient protocol for validation of hardware produced elsewhere.
This is the unique path to avoid that in future any device firmware can be tainted with malicious backdoor, this paper is the proof that introducing a new type of sub-transistor level hardware Trojan is possible just modifying the dopant masks without using additional components, circumstance that make the hardware trojan difficult to detect.
Pierluigi Paganini
(Security Affairs –  Hardware Trojan, Malware)  
