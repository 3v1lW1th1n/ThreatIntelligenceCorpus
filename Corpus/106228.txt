Researchers Find Serious Problems in Chip and PIN EMV Implementation, Protocol
Chip-and-PIN payment cards are coming to the United States after a long head start as a standard card-present payment method in Europe and Asia.
Already, retailer Target accelerated its plan to move its branded debit and credit cards to chip-and-PIN, also known as EMV (Europay, MasterCard and Visa), in short order following a devastating data breach during the Christmas shopping season. Other retailers are sure to follow, especially with an October 2015 deadline approaching imposed by Visa where it will institute a liability shift where the party causing a fraudulent transaction will be responsible for losses if chip-and-PIN is not part of the transaction.
While chip-and-PIN may shore up some of the authentication anxiety surrounding payment card transactions, it’s not a cure-all for fraud, and it does come with its share of security baggage and vulnerabilities.
The latest evidence came in a recently published paper by computer scientists at the University of Cambridge in the U.K. The report describes two critical problems, an implementation flaw and a serious issue in the protocol that the researchers say will be much more difficult to fix.
The team Mike Bond, Omar Choudary, Steven J. Murdoch, Sergei Skorobogatov and Ross Anderson said that the chip in EMV cards that generates what is supposed to be an unpredictable number, or nonce, for each transaction to ensure its integrity does quite the opposite because of an implementation flaw.
“Some EMV implementers have merely used counters, timestamps or home-grown algorithms to supply this nonce,” the paper said. “This exposes them to a ‘pre-play’ attack which is indistinguishable from card cloning from the standpoint of the logs available to the card-issuing bank, and can be carried out even if it is impossible to clone a card physically.”
EMV chips are in place largely to ward off card cloning, which is facilitated much easier by cards with just a magnetic strip storing data. The researchers explain in the paper how attacks can be carried out against ATMs and other payment terminals.
“We found flaws in widely-used ATMs from the largest manufacturers,” the paper said. “We can now explain at least some of the increasing number of frauds in which victims are refused refunds by banks which claim that EMV cards cannot be cloned and that a customer involved in a dispute must therefore be mistaken or complicit.”
As with other random number generators, the predictability of the number is a serious issue for a determined thief.
“This might create the opportunity for an attack in which a criminal with temporary access to a card (say, in a Mafia-owned shop) can compute the authentication codes needed to draw cash from that ATM at some time in the future for which the value of the [unpredictable number] can be predicted,” the paper said.
The protocol vulnerability, meanwhile, arose out of studying the problem with random nonce generation wherein an attacker can swap out the random number generated by an ATM or payment terminal with one from a cloned card.
“This variant of the pre-play attack may be carried out by malware in an ATM or POS terminal, or by a man-in-the-middle between the terminal and the acquirer,” the paper said.
An attacker would have to be in a man-in-the-middle position between the card and payment terminal or between the terminal and the acquiring bank. Malware infecting the terminal can attack the EMV protocol as well, the paper said.
“The banks appear to have ignored this, perhaps reasoning that it is difficult to scale up an attack that involves access to specific physical cards and also the installation of malware or wiretaps on specific terminals,” the paper said. “We disagree. The Target compromise shows that criminals can deploy malware on merchant terminals widely and exploit it to earn serious money.”
