August in November: New Information Stealer Hits the Scene
Overview
During the month of November, Proofpoint observed multiple campaigns from TA530 - an actor we have noted for their highly personalized campaigns [6] - targeting customer service and managerial staff at retailers. These campaigns utilized “fileless” loading of a relatively new malware called August through the use of Word macros and PowerShell. August contains stealing functionality targeting credentials and sensitive documents from the infected computer.
Delivery and Targeting
During our analysis we found that many of the lures and subject lines of the emails used references to issues with supposed purchases on the company’s website and were targeted at individuals who may be able to provide support for those issues. The lures also suggested that the attached document contained detailed information about the issue. However, the documents contained macros that could download and install August Stealer.
The subject lines were personalized with the recipient's domain. Examples included:

Figure 1: Example email used to deliver the macro-laden document

Figure 2: Example email used to deliver the macro-laden document

Figure 3: Example macro-laden document attachment used to deliver August
The macro used is very similar to the one we discussed in our previous post detailing sandbox evasion techniques used to deliver the Ursnif banking Trojan [1]. It filters out security researchers and sandboxes using checks including Maxmind, task counts, task names, and recent file counts. Notably, the macro used in this campaign launches a Powershell command to “filelessly” load the payload from a byte array hosted on a remote site. This actor previously used this technique to load POS payloads [2][3][4].

Figure 4: Example PowerShell command used to download and execute the byte array

Figure 5: Snippet of the network traffic returning the byte array used to load August
The screenshot above shows the payload downloaded from the remote site as a PowerShell byte array. In addition to the byte array itself, there are few lines of code that deobfuscate the array through an XOR operation, and execute the “Main” function of the payload.
Analysis
August is written in .NET, with samples obfuscated with Confuser [5]. We determined from the source code of a particular sample that August can

Figure 6: The “Main” function executed from the PowerShell command

Figure 7: Determines the presence of security tools, and does not communicate with the C&C if they are found

Figure 8: Network data encryption

Figure 9: Example encrypted traffic generated by August

Figure 10: August configured to search and upload .txt and .doc files to the server

Figure 11: August control panel with stolen credentials for FTP, messenger, mail, RDP, and other programs
Conclusion
August is a new information stealer currently being distributed by threat actor TA530 through socially engineered emails with attached malicious documents. While this actor is largely targeting retailers and manufacturers with large B2C sales operations, August could be used to steal credentials and files in a wide range of scenarios. The malware itself is obfuscated while the macro used in these distribution campaigns employs a number of evasion techniques and a fileless approach to load the malware via PowerShell. All of these factors increase the difficulty of detection, both at the gateway and the endpoint. As email lures become increasingly sophisticated and personalized, organizations need to rely more heavily on email gateways capable of detecting macros with sandbox evasion built in as well as user education that addresses emails that do not initially look suspicious.
