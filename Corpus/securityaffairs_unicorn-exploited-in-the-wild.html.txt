
					Windows Unicorn vulnerability exploited in the wild					
On November 11th Microsoft has released that exploit the Unicorn (CVE-2014-6332) critical remote code execution vulnerability in Windows systems, which Microsoft patched on November 11th.
The Unicorn vulnerability is addressed in one of the 14 security bulletins released by Microsoft on November 11, MS14-064 is one of the most important.
The bulletin addresses a Windows OLE RCE bug (CVE-2014-6352) and another Windows Object Linking and Embedding (OLE) automation array RCE flaw (CVE-2014-6332).
The CVE-2014-6332 vulnerability allows a remote attacker to execute arbitrary code via a crafted web site, the flaw is also known as “Windows OLE Automation Array Remote Code Execution Vulnerability”, WinShock or Unicorn. The Unicorn flaw was reported to Microsoft in May by researchers from IBM and experts discovered that it has existed for at least 19 years.
“The bug can be used by an attacker for drive-by attacks to reliably run code remotely and take over the user’s machine — even sidestepping the Enhanced Protected Mode (EPM) sandbox in IE 11 as well as the highly regarded Enhanced Mitigation Experience Toolkit (EMET) anti-exploitation tool Microsoft offers for free,” IBM reported in the blog post.
The CVE-2014-6352 allows a remote attacker to execute arbitrary code via a crafted OLE object, in October Microsoft issued the security advisory 3010060 to warn its customer of the Zero-Day vulnerability that affects all supported versions of Windows OS except, Windows Server 2003.
Microsoft warned that the flaw is already being exploited in limited targeted attacks by threat actors in the wild.
“The vulnerability could allow remote code execution if a user opens a specially crafted Microsoft Office file that contains an OLE object. An attacker who successfully exploited the vulnerability could gain the same user rights as the current user,” the advisory explained.”At this time, we are aware of limited, targeted attacks that attempt to exploit the vulnerability through Microsoft PowerPoint.” confirming the voice that bad actors are already exploiting the zero-day in limited cases.
Recently a Chinese researcher released proof-of-concept (PoC) code for the exploitation of the Unicorn vulnerability concurrently with the release of the official patch by Microsoft. The day after the disclosure of the flaw, it was also available a Metasploit module that exploit the Unicorn flaw. On November 17th, NSS Labs uncovered attacks exploiting CVE-2014-6332 through a JavaScript hosted on a South Korean website, the script was used to discriminate the visitors and serve the appropriate exploit. If a mobile device running Android is detected, an APK file is served, meanwhile if a PC is detected, a malware is dropped via the exploit published by the Chinese expert.

Below the Timeline of the events
“The malware is a little different to that which is typically dropped from regular exploit kits and malware campaigns. The difference lies in the way in which this malware is packaged, and in its method of operation,” NSS Labs wrote in a Nov. 20 blog post. “The packer used within this malware is NSPack, the malware carries an embedded copy of itself for the purpose of dissemination.”
Also the experts at ESET firm have discovered an attack leveraging the Unicorn vulnerability through the website of a major news agency in Bulgaria.
“Scouring our data, we found several blocked exploitation attempts while our users were browsing a major Bulgarian website. As you might have guessed, the compromised website was using CVE-2014-6332 to install malware on the computers of its unsuspecting visitors.” reports ESET in a blog post.
Also in this case the hackers exploited the PoC released by the Chinese expert to serve a multi-use malware.
Pierluigi Paganini
(Security Affairs –  Unicorn vulnerability,Windows)
