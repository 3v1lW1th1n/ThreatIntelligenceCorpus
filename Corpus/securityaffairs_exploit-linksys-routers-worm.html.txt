
					Linksys routers worm – Released the code for exploit the vulnerability					
Last week I reported the news related to a vulnerability in Linksys routers that’s being exploited by a new The Moon worm analyzed by the SANS Institute’s Internet Storm Center. The Moon is a self-replicating malware which is spreading among many different Linksys routers. The Moon exploits an authentication bypassflaw to infect Linksys routers, SANS located the vulnerability in a CGI script in the administration interface of different Linksys’ E-Series router models avoiding to provide information on the flawed CGI script. During the weekend it was published  on Reddit the list of alleged vulnerable CGI scripts in the Linksys routers and later a different user with the nickname Rew has confirmed that at least two of those scripts are vulnerable. Rew has made much more, because he also published a proof-of-concept exploit.

 On Sunday, a Reddit user identified four CGI scripts that he believed were likely to be vulnerable. An exploit writer, who uses the online alias Rew, later confirmed that at least two of those scripts are vulnerable and published a proof-of-concept exploit.
“I was hoping this would stay under-wraps until a firmware patch could be released, but it appears the cat is out of the bag…  http://www.reddit.com/r/netsec/comments/1xy9k6/that_new_linksys_worm/ Since it’s now public, here’s my take on it.” “Currently only working over the LAN. I think there may be an iptables issue or something. Left as an exercise to the reader.” Rew wrote in the exploit notes.
Rew also reported in the script the list of Linksys routers might be affected by the flaw, it includes models belonging Linksys E-Series and Wireless-N series:
E4200, E3200, E3000, E2500, E2100L, E2000, E1550, E1500, E1200, E1000, E900, E300, WAG320N, WAP300N, WAP610N, WES610N, WET610N, WRT610N, WRT600N, WRT400N, WRT320N, WRT160N and WRT150N. 
Linksys confirmed the presence of the vulnerability in its devices:
“Linksys is aware of the malware called ‘The Moon’ that has affected select older Linksys E-Series routers and select older Wireless-N access points and routers,” “The exploit to bypass the admin authentication used by the worm only works when the Remote Management Access feature is enabled. Linksys ships these products with the Remote Management Access feature turned off by default.” “Linksys will be working on the affected products with a firmware fix that is planned to be posted on our website in the coming weeks,”said Karen Sohl, director of global communications at Belkin, the company owned by Linksys. 
Linksys published an article to instruct its users on the installation of the latest firmware version and to invite them to disable remote management, it also has planned the release of a firmware fix in the coming weeks.

Pierluigi Paganini
(Security Affairs –  Linksys routers, The Moon worm)
