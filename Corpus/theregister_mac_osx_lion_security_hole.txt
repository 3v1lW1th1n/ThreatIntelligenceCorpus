Mac Lion blindly accepts any LDAP password
Apple's latest version of Mac OS X is creating serious security risks for businesses that use it to interact with a popular form of centralized networks.
People logging in to Macs running OS X 10.7, aka Lion, can access restricted resources using any password they want when the machines use a popular technology known as LDAP for authentication. Short for Lightweight Directory Access Protocol, LDAP servers frequently contain repositories of highly sensitive enterprise data, making them a goldmine to attackers trying to burrow their way in to sensitive networks.
“As pen testers, one of the first things we do is attack the LDAP server,” Rob Graham, CEO of auditing firm Errata Security, said. “Once we own an LDAP server we own everything. I can walk up to any laptop (in an organization) and log into it.”
The LDAP breakdowns in Lion aren't well understood because Apple still hasn't admitted there's any problem. But according to threads here and here, it affects Macs running Lion that use LDAP to authenticate users to different desktop machines. After the initial login, Lion users can log in with any password. Apple's latest operating system, which was released last month, blindly accepts whatever pass code it's given.
Machines running Linux, Windows, and earlier versions of OS X authenticate just fine on the same LDAP servers, participants in the discussions reported. The are no widespread reports of problems when Lion machines log into networks that use protocols that compete with LDAP.
“Even though we have Open Directory running now (snark snark), we use OpenLDAP for our datacenter access and for clients,” a MacRumors newbie named monachus wrote. “Simply having Lion installed is a security vulnerability, as any user who can access OD settings can connect to the datacenter as any other users. It's a HUGE hole.”
The user said his company has delayed a company-wide upgrade to Lion because of the issue.
Lion users said the problem arose only after upgrading from earlier OS X versions. The first report was made on July 25, five days after the newest OS was released. Amazingly, Apple allowed the the security hole to persist even after last week's release of Lion 10.7.1, which fixed audio, video, and Wi-Fi glitches.
Apple's Mac has long been considered a safe haven from the malware and social engineering attacks that mar the experience of so many users of Microsoft's Windows OS. That's partly because the Mac's considerably smaller market share doesn't make it worth the investment to write highly weaponized exploits that hijack OS X users. It's also due in part to the non-trivial amount of resources and talent Apple has put into securing the OS, particularly in Lion.
Macs may be an excellent choice for individuals looking for a machine that's resistant to today's malware attacks found in the wild, but enterprises should think twice before deploying large fleets of them, a prominent security consultancy said recently. The recommendation is based on the finding that many of the OS X components used to administer Macs lack secure authentication protocols, making networks vulnerable to so-called APTs.
Short for advanced persistent threats, APTs are used to describe stealthy attacks used to steal proprietary data and national security information, such as those that have penetrated Google, RSA, and dozens of other corporations over the past 18 months.
“It's a pretty big deal for customers using LDAP as their authentication scheme, and it demonstrates that enterprise deployment scenarios are obviously not part of Apple's regression testing plan,” said Alex Stamos, one of the researchers at iSec Partners who said large corporate customers probably shouldn't deploy large number of Macs for now. “Hopefully heavy coverage of these issues will lead Apple to invest security resources into improving the areas of OS X important to enterprise users, not just end consumers.” ®

This article was updated to change language describing protocols that compete with LDAP and threats facing Macs.


Sponsored: 
Following Bottomline’s journey to the Hybrid Cloud

