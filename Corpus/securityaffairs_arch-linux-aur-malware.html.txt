
					A tainted version of Arch Linux PDF reader package found in a user-provided AUR					
Hackers have poisoned the Arch Linux PDF reader package, this means that users who have downloaded recently a PDF viewer named “acroread” may have been compromised.
ThePDF reader package has been tainted with a malware and Arch Linux has removed the user-provided AUR (Arch User Repository).
This incident raises the discussion about the installation of software from untrusted sources and the possibility that threat actors poison the supply chain.
The specific user repository had been abandoned by its maintainer leaving open the doors for a threat actor.
Someone using the handle “xeactor” modified the package by adding a downloader script that loads a malicious code hosted on a server maintained by the attackers.
The maintainer Eli Schwartz quickly reverted the commits after discovering the hack, it also suspended the account of xeactor.
“The acroread AUR package appears to have been compromised: look at https://aur.archlinux.org/cgit/aur.git/commit/?h=acroread&id= b3fec9f2f16703c2dae9e793f75ad6e0d98509bc (and in particular that curl|bash line!). Not exactly sure who to contact, but I assume someone on this list can get things sorted out.” wrote Schwartz.
“Account suspended, commit reverted using Trusted User privileges.”
Schwartz also discovered two other packages that were tainted with a similar technique, both have been removed.
The user Bennett Piater wrote in the Arch Linux mailing that he noticed a suspect script that creates ‘compromised.txt’ in the root and all home folders.”
“Looks to me like this is more of a warning than anything else, no? Why would he create those files otherwise, given how much attention that would attract?” Piater said.
The acroread was used by attackers as a dropper and the script would set the systemd to restart on a regular basis, a circumstance confirmed by Schwartz too.
“Side note on the acroread pastes: https://ptpb.pw/~xwas executed by the PKGBUILD, which in turn executed https://ptpb.pw/~u. But the thing it installed declares an ssupload()function then tries to execute the contents of $uploader to actually upload the data collection.” wrote Schwartz.

The good news is that the malicious software could not work.
Arch maintainer Giancarlo Razzolini tried to downplay the problem explaining the usage of AUR clearly could expose users at risk, but it is their choice.
“This would be a warning for what exactly? That orphaned packages can be adopted by anyone? That we have a big bold disclaimer on the front page of the AUR clearly stating that you should use any content at your own risk? This thread is attracting way more attention than warranted. I’m surprised that this type of silly package takeover and malware introduction doesn’t happen more often.” wrote Razzolini.
“This is why we insist users always download the PKGBUILD from the AUR, inspect it and build it themselves. Helpers that do everything automatically and users that don’t pay attention, *will* have issues. You should use helpers even more so at your risk than the AUR itself.”
Pierluigi Paganini
(Security Affairs – Arch Linux, hacking)
