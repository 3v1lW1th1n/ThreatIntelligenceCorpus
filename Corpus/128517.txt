BoundHook Attack Exploits Intel Skylake MPX Feature
A post-intrusion technique developed by researchers at CyberArk Labs called BoundHooking allows attackers to exploit a feature in all Intel chips introduced since Skylake. The attack technique allows for the execution of code from any process without detection by antivirus software or other security measures, researchers said.
According to CyberArk, a BoundHooking attack exploits the Intel feature called Memory Protection Extension (MPX) to hook function calls that pass between software components. That allows for an adversary to manipulate and spy on a wide range of Windows applications.
“Some of the software that utilizes hooks include: application security solutions, system utilities, tools for programming, malicious software and others,” said Kasif Dekel security researcher at CyberArk.
Dekel said the prerequisite for its proof-of-concept attack are the presence of an Intel CPU (Skylake or after) running MPX concurrently with Windows 10 (64-bit or 32-bit). Adversaries must also have already fully compromised the targeted system.
“The beauty of these type attacks is that an adversary’s actions can go undetected,” said Doron Naim, senior security researcher at CyberArk.
Researchers said the BoundHook technique, explained in a technical report released Wednesday, is able to cause an exception in a specific memory location in a user-mode context. Next, it is able to catch the exception and gain control over the thread execution used by a specific application. For example, the technique could allow for the interception of a keyboard event message passed between Windows and a specific service, allowing an attacker to capture or manipulate a victim’s keystrokes.
The technique is similar a proof-of-concept attack explained earlier this year by CyberArk called GhostHook. That technique bypassed Microsoft’s PatchGuard kernel protection in Windows 10 via the Intel feature Processor Trace. The GhostHook technique was different. That attack method bypassed Microsoft’s attempts to prevent kernel level attacks (via PatchGuard) and used the hooking approach to take control of a device at the kernel level.
As was the case with GhostHook and also now with BoundHooking, Microsoft and Intel don’t see either as a vulnerability on their end. Both told CyberArk it will not patch the issue because the attack requires that the adversary already has already fully compromised the targeted system.
Naim said that such an attack is within the realm of a nation-state attacker and that some well-known targeted intrusions such as Flame and Shamoon could easily make use of malware to establish a foothold on machines and networks. Once that foothold is established, adversaries can easily go unnoticed.
CyberArk researchers said they believe Microsoft should address this type of vulnerability. “We know that BoundHook does not meet Microsoft’s bar to be considered a vulnerability, as machine administrator rights are already compromised,” the company wrote on its blog.
In a message back to CyberArk from Microsoft responding to the researchers disclosure it wrote, “we have completed our investigation of this issue and have found that it is not a vulnerability but a technique to avoid detection once the machine is already compromised.”
In lieu of a Microsoft patch, CyberArk researchers said admin should rein-in user account privileges to minimize the type of lateral and system penetration an adversary can carry out in a BoundHooking attack.
“There are two goals to publishing the research,” Naim said. “The first is to bring attention to the technique so Microsoft eventually will fix the problem. Second, for the end users, we want to strengthen the idea of the importance of protecting admin privileges, since BoundHook is not a problem if a user’s admin privileges are protected.”
