
					Joining the dots between the ancient Moonlight Maze espionage campaigns and the Turla APT					
One year ago, the researcher Thomas Rid at the Security Analyst Summit disclosed the alleged links between the Moonlight Maze cyber espionage operation of mid 1990s and the Turla APT.
Today at the annual Kaspersky Lab conference, Rid, along security experts Costin Raiu and Juan Andres Guerrero-Saade presented the findings of its research that definitively connect the Moonlight Maze cyber espionage campaigns to the Russian APT group.

Moonlight Maze is the code name assigned to one of the first detected cyber espionage campaigns that targeted a number of critical U.S. government agencies, including the Pentagon, NASA and the Department of Energy.

Threat actors behind the Moonlight Maze were focused on UNIX systems such as Sun Solaris, while the Turla APT is more specialized in attacks on Windows systems.
The researchers speculated that the missing link between the two cyber espionage operations lies in the Penquin Turla attacks dated back 2011 and spotted by Kaspersky Lab in 2014. Penguin Turla was designed to compromise Linux machines with a backdoor based on the open-source LOKI2 backdoor that was released in Phrack magazine in September 1997.
“The revelation that the Moonlight Maze attacks were dependent on a Solaris/*NIX toolkit and not a Windows one as is the case with most of Turla, actually revived our hopes.” reads the analysis published by Kaspersky.  “In 2014, Kaspersky announced the discovery of Penquin Turla, a Linux backdoor leveraged by Turla in specific attacks. We turned our attention once again to the rare Penquin samples and noticed something interesting: the code was compiled for the Linux Kernel versions 2.2.0 and 2.2.5, released in 1999. Moreover, the statically linked binaries libpcap and OpenSSL corresponded to versions released in the early 2000s. Finally, despite the original assessment incorrectly surmising that Penquin Turla was based on cd00r (an open-source backdoor by fx), it was actually based on LOKI2, another open-source backdoor for covert exfiltration written by Alhambra and daemon9 and released in Phrack in the late 1990s.”
Guerrero-Saade explained that of the 45 Moonlight Maze binaries that were detected by experts at Kaspersky, nine of them were examples of the LOKI2 backdoor.
This discovery is amazing because it demonstrates a 20-year-old hacking tool is still effective against high-value targets.
“This speaks to the state of Linux security and the lack of awareness—and even hubris—that goes into some Linux system administration, an ill-advised approach for government and corporate settings,” Guerrero-Saade said. “These guys (Moonlight Maze) didn’t have to play the cat-and-mouse game with antivirus companies or rewrite their toolkit 30 times to get it through VirusTotal and still hope it works. It’s terrifying to see that the evolved Penquin Turla samples are based on 20 year old code and still linked to libraries built in 1999-2004 and they still work on modern machines. You’d never see that on Windows.”
Summarizing the possible link between the Moonlight Maze’s early UNIX and Solaris toolkits and modern Turla Windows attacks is the LOKI2 backdoor used in the Penguin Turla attacks.
The researchers conducted an intriguing a lucky investigation, they have found the original artifacts thanks a system administrator in the U.K. named David Hedges who in cooperation with the London Metropolitan Police and the FBI logged every keystroke happening on a server targeted by the Moonlight Maze. The researchers were able to find Hedges because of a redaction error in an FBI FOIA release.
Hedges confirmed that the server was still running and he provided access to logs that include evidence of the Moonlight Maze operation, along with the a toolkit with 43 binaries used in their attacks.
The investigation revealed further details, the researchers focused on a little-known operation codenamed ‘Storm Cloud’. The toolkit used in the attacks was an evolution of the toolkit leveraged by the same Moonlight Maze threat actors.
The first attacks became public in 1999, Storm Cloud was also made public four years later, and also in this case, the code was based on the LOKI2 backdoor.
“We’re really trying to push the crowdsourcing element to this,” Guerrero-Saade said. “Thomas’ first talk helped us find David and more about Moonlight Maze. We need help. We need another David Hedges, someone with access to the Storm Cloud artifacts to really solidify this link.”
Pierluigi Paganini
(Security Affairs –  Penquin Turla, cyber espionage)
