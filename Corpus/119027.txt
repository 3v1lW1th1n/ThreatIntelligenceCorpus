Scope of ThinkPwn UEFI Zero Day Expands
A serious hardware vulnerability, thought to be confined to UEFI drivers in Lenovo and HP laptops, has also been found in firmware running on motherboards sold by Gigabyte.
The flaw was publicly disclosed last week by researcher Dmytro Oleksiuk. No patches are yet available.
Oleksiuk said the flaw, which he calls ThinkPwn, is in the SystemSmmRuntimeRt UEFI driver, which he found on firmware in Lenovo ThinkPad laptops.
“Vulnerability is present in all of the ThinkPad series laptops, the oldest one that I have checked is X220 and the newest one is T450s (with latest firmware versions available at this moment),” Oleksiuk wrote on a Github entry. Oleksiuk published proof-of-concept exploit code for the vulnerability last week along with his disclosure.
An attacker exploiting the vulnerability will gain privileges that will allow them to run arbitrary code in System Management mode and potentially disable flash write protection which defends against code execution. An attacker would also be able to shut down other security protections such as Secure Boot or bypass Virtual Secure Mode, including Credential Guard, on Windows 10 machines.
Lenovo responded last week that its investigation is ongoing and that the vulnerable System Management Mode code was written by Intel and came to Lenovo from one of its BIOS vendors; these suppliers take original chip code from Intel and AMD and customize them to work with specific computers.
“The package of code with the SMM vulnerability was developed on top of a common code base provided to the IBV by Intel. Importantly, because Lenovo did not develop the vulnerable SMM code and is still in the process of determining the identity of the original author, it does not know its originally intended purpose,” Lenovo said in its statement. “But, as part of the ongoing investigation, Lenovo is engaging all of its IBVs as well as Intel to identify or rule out any additional instances of the vulnerability’s presence in the BIOS provided to Lenovo by other IBVs, as well as the original purpose of the vulnerable code.”
As of this morning, Lenovo still has not provided a security update.
A request for additional comment from Oleksiuk was not returned in time for publication. Researcher Alex James said that the vulnerable code was also found in HP Pavilion laptops and today that Gigabyte motherboards (Z68-UD3H, Z77X-UD5H, Z87MX-D3H, Z97-D3H and many others) were also carrying the vulnerable SMM code.
Oleksiuk, who has found and disclosed other UEFI vulnerabilities before, provides technical details on his blog along.
“I decided to do the full disclosure because the main goal of my UEFI series articles is to share the knowledge, not to make vendors and their users happy,” Oleksiuk wrote. “Also, I don’t have enough resources to check the vulnerability on all of the Lenovo computers, so, if you have ThinkPad — it’s likely vulnerable, in case of other model lines I’d recommend to wait for official advisory from vendor. It’s very unlikely that this vulnerability will be exploited in the wild, for regular customers there are much more chances to be killed with the lightning strike than meet any System Management Mode exploit or malware.”
