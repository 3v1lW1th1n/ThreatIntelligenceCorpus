Researchers Say More Spectre-Related CPU Flaws On HorizonAfter another speculative execution side channel-related flaw has been disclosed in processors,  security experts say that more may be on the horizon.Researchers on Monday disclosed Variant 4, a new speculative execution side channel category flaw that allows attackers to read privileged data across trust boundaries. Variant 4 is similar to two side channel analysis vulnerabilities, Meltdown and Spectre, that came into the spotlight earlier this year in an array of Intel server and desktop processors.And that may not be the end. “Everyone thought there would be lots more of these types of vulnerabilities,”  Tod Beardsley, principle security research manager of Rapid7, told Threatpost. “I would be shocked if there wasn’t something else out there being discussed under embargo right now.”Speculative execution has long existed in processors – but researchers say that as the cache that exists on processors grows to keep up with their speed, so to does the risk of exploiting  this type of flaw.“I think people will figure out more ways around this type of vulnerability… it’s a foundational architecture issue,” said Martin Reynolds, VP and Gartner Fellow in an interview with Threatpost. “This is a very broad vulnerability that goes back a long time, but in recent years we’ve seen them grow more vulnerable… The thing that makes it different now is that they’re doing it with such long strings of code now that they’re trying to get in there and send more signals.”The problem is that to stay faster and perform better, processors use a trick which use speculative execution of memory to read before the addresses of all prior memory writes are known.The most common form of speculative execution involves a program’s control flow. The processor essentially predicts the control flow using a highly sophisticated set of mechanisms instead of waiting for all branch instructions to resolve to determine which operations are needed to execute.While this method acts as a buffer so processors can then quickly skip to other processes and stay as optimal as possible, it also enables an attacker with local user access using a side-channel analysis to gain unauthorized disclosure of information.“So this gap continues to grow, and that’s why in recent years we’ve seen these things grow more vulnerable,” said Reynolds. “Before that, processors didn’t have enough memory, enough speculative execution where you could do anything useful.”In the case of Variant 4, which is a speculative store bypass method, it takes advantage of a performance feature present in many high- performance processors that “allows loads to speculatively execute even if the address of preceding potentially overlapping store is unknown,” according to Intel.Speculative execution side-channel attacks are difficult to exploit; but not impossible. Intel for its part said that it is not aware of a successful browser exploit for Variant 4. Furthermore, the risks surrounding Varant 4 do not lead to a mass attack, but narrow customized attacks where someone uses a specific attack for one system.“Variant 4 is mostly being discussed in a fairly narrow scope: accessing specific unpatched browser’s private data,” said Rob Tate, researcher at WhiteHat Security. “If an attacker has access to run code on a machine, there are already a number of simpler (and more universal) techniques to try before resorting to this, and it’s far from the wide-reaching implications of the original Spectre.”Patching ProblemsWhile it may be hard to exploit a speculative execution side channel vulnerability, it is also notoriously difficult to patch that type of flaw as well.“It’s hard to fix these, especially when it impacts an install base that’s so big,” said Reynolds. “You can fix variants in the OS, as Google and Amazon have done for Spectre, to eliminate the problem, or can change the microcode of the microprocessor itself, but that may make the system slower.”Spectre and Meltdown also infamously faced messy patching efforts across the industry in the wake of the vulnerability disclosure after acknowledging that its patches caused “higher than expected reboots and other unpredictable system behavior.” Variant 4 may be on the same path – Intel said on Monday the fixes for the flaw could also impact performance by between 2 and 8 percent for certain systems.Another challenge to patching flaws like Spectre, Meltdown and Variant 4 is the immense amount of coordination it takes from an array of vendors, said Beardsley.  Already, vendors such as Red Hat, AMD, ARM, IBM and Microsoft have come forward discussing their future approaches to Variant 4.Intel, for its part, said that the speculative store bypass method mitigation for Variant 4 can be accomplished through modifying the software of impacted code or setting a new Speculative Store Bypass Disable MSR bit through software.“As speculative store bypass can only occur when a load is able to execute before an older store with an overlapping address computes its address, an LFENCE between that store and the subsequent load is sufficient to prevent this case,” the company said in a white paper about the vulnerability. “Software should be careful to apply this mitigation judiciously to avoid unnecessary performance loss.”