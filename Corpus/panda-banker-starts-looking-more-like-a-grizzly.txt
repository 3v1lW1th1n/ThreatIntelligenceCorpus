Bad News Bears - Panda Banker Starts Looking More Like a Grizzly
Proofpoint researchers originally discovered the Panda Banker malware in February, 2016 [1]. At the time, it was being distributed via both targeted email campaigns and exploit kits (EKs). The instance we discovered and analyzed at the time was configured to steal information from customers of UK and Australian banks. While Panda Banker has become more prevalent in recent weeks, we have been tracking a large campaign this week targeting banks in Europe and Australia and, interestingly, UK online casinos and international online payment systems.
Email campaign
On August 11 and 12, Proofpoint detected the largest Panda Banker email campaign we have ever observed with millions of messages sent to organizations involved in manufacturing, retail, insurance, and several other verticals. Email messages in this campaign purport to be from legitimate banks with malicious links leading to Microsoft Word documents. These documents contain macros which, if enabled, download Panda banker with a botnet ID of "cap".
The messages in this campaign were translated into Dutch, German, Italian, and English, depending on the targeted country. English-speaking countries included Australia and the United Kingdom, and Subject lines included:

Figure 1: English language email lure with fraudulent use of a legitimate bank name to deliver the malicious URLs that eventually lead to Zeus Panda

Figure 2: Linked Microsoft Word document that uses macros and social engineering to download Zeus Panda

Figure 3: German language email lure
Web injects
Banking Trojans generally rely on web injects to intercept online banking traffic and often to modify banking sites on infected devices in order to carry out man-in-the-browser (MITB) attacks. These web injects are configured for specific banks in targeted countries. In this case, the injects are set up for banks in the Netherlands, Italy, and Germany as well as online casinos in the United Kingdom and international online payment systems. We observed the following sites targeted by web injects:
These web injects represent a substantial expansion of the injects we initially observed in Panda Banker in February and March. While banks are common targets for injects, the addition of online casinos in the UK and international payment systems like OKPay, PayPal, and Xoom dramatically increases the potential attack surface for Panda Banker since these payment systems are not limited by geography like most banks.
Analysis
We analyzed the command and control (C&C) functions, control panel, mutexes, and specific functions previously [1]. Substantive changes appear to be largely limited to the web injects, encryption of the configuration file [2], and targeting rather than major updates to core functionailty, although at this time we have not fully reversed this latest version of Panda Banker.
Conclusion
Panda Banker is one of many banking Trojans with roots in Zeus, one of the earliest and most successful banking Trojans. As the massive Dridex campaigns of 2015 and early 2016 essentially saturated their target countries, other banking Trojans such as Vawtrak and Ursnif have emerged to fill the void. Now Panda Banker is also appearing at scale to steal money via online banking accounts, including international online payment systems.
Even as attention turns to ransomware like Locky and CryptXXX, this campaign shows that banking Trojans are far from dead. Both individuals and organizations must remain vigilant to the threat, especially in regions that have not previously experienced the onslaught of Dridex and hardened their defenses accordingly. Protection at both the email gateway and endpoint will be critical to keeping a new generation of banking Trojans at bay.
