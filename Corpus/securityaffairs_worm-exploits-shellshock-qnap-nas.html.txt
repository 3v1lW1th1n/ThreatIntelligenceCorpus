
					Worm exploits Shellshock to infect QNAP systems					
Experts at Sans Institute have discovered a new series of attacks in the wild exploiting the Shellshock attack code to compromise disk storage systems made by the Taiwan-based QNAP firm. The threat actors used a worm that targets the NSA systems and install a backdoor on them.
In a blog post published by the Sans Institute, the experts explained that despite QNAP has released a patch in early October, many devices were infected by the worm, a circumstance that suggest that there are still a lot of users that haven’t updated their systems.
Let’s remember that the exploitation of the Shellshock bug allows attackers to remotely execute malicious code on the vulnerable target.
“The attack targets a QNAP CGI script, /cgi-bin/authLogin.cgi, a well known vector for Shellshock on QNAP devices,” wrote the researchers Johannes B. Ullrich  in the post. “This script is called during login, and reachable without authentication. The exploit is then used to launch a simple shell script that will download and execute a number of additional pieces of malware.”
The attack scenario is very interesting, once infected a QNAP system, which is equipped with a secure shell (SSH) server, the worm creates a new administrative user to gain a persistent backdoor on the target. The worm also patches the Shellshock flaw, presumably to avoid that other malware could exploit it. Infected devices also execute a script that makes them carry out a click-fraud scam against the advertising network JuiceADV.
“Infected devices have been observed scanning for other vulnerable devices. I was not able to recover all of the scripts the code on pastebin downloads. The scanner may be contained in one of the additional scripts.”

Below the detailed list of actions performed by the worm:
The worm also installs many other malicious components, admins who still haven’t patched their QNAP system have to update them urgently.
Pierluigi Paganini
(Security Affairs –  Shell Shock, QNAP system)
