
					Was Torrent Site The Pirate Bay Being Sneaky or Creative By Tricking Visitors Into Monero Mining					
Pop quiz: would you rather A) see ad banners displayed at the top of the website, or B) mine Monero cryptocurrency when you visit a website? Judging by the number of downloads for ad blocking browser extensions, no one likes banner ads. But if you ask The Pirate Bay this week, they will probably say the same thing about secretive Monero mining.
In August, security researchers at Netskope identified a malvertising campaign that downloaded the Zminer coin-miner and then used victims’ computers to mine Monero and Zcash cryptocurrencies for the benefit of the bad actors.
According to Threat Post, “Netskope provided details on two separate operations that have netted 101 Monero, or $8,300 USD, and 44 Zcash, or $10,100 USD so far. Zminer uses Monero on 32-bit Windows systems, and Zcash on 64-bit.”

The challenge with most cryptocurrency mining is that the cost of operating the mining machines (e.g. electricity) eat away at much of the profit potential. But for the bad actors, victims pay the operating costs while the profits are reaped by the ones poisoning the banner ad system. When there are no costs, mining cryptocurrencies can be lucrative.
Last week a very observant Redditor Intertubes_Unclogger noticed that his CPU threads spiked to 80-85% visiting some pages on the very popular Torrent search site, The Pirate Bay (TPB). It is very unlikely that simple web browsing would cause such a spike so it was apparent something unexpected was going on. After some trial and error the Redditor determined that the ScriptSafe  Chrome extension was preventing the process that caused the CPU spike. The Reddit community participating in solving the mystery guessed that TPB may have been unknowingly involved in a “shady bitcoin mining operation.” It turns out they were very close to the truth.
TPB was serving up shady Monero mining malware on some of its pages, but it wasn’t unexpected. From the official TPB blog,
“This is only a test. We really want to get rid of all the ads. But we also need enough money to keep the site running,” a site admin posted on The Pirate Bay’s blog, “Let us know what you think in the comments. Do you want ads or do you want to give away a few of your CPU cycles every time you visit the site?”
It turns out that TPB was experimenting with Coin Hive which is described as “a JavaScript miner for the Monero Blockchain that you can embed in your website. Your users run the miner directly in their Browser and mine XMR for you in turn for an ad-free experience, in-game currency or whatever incentives you can come up with.” Coin Hive themselves recommend that websites notify their users rather than sneakily stealing CPU cycles as TPB did. An admin at TPB suggested that there was a mistake made with the initial install as the miner was only expected to use 20-30% of the visitors’ CPU. This sounds a lot like “we didn’t think anyone would notice.”
At the end of the day, the general consensus in the /r/thepiratebay subreddit seems to be supportive of TPB’s attempts to fund their activities through means other than banner ads. And for users that would prefer to choose whether they are mining for someone else’s benefit, there are JavaScript and ad blocker extensions for the web browsers. This is evidence of one more reason why you need to control what is running in your browser.
 
 
Pierluigi Paganini
(Security Affairs – Mining, The Pirate Bay)
