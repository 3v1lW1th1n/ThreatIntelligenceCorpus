
Resources
Contact us

Resources
Contact us


BAE Systems Threat Research Blog




Pages


Home


Products


Solutions


News & Events


Partners


About Us


Careers



Home


Products


Solutions


News & Events


Partners


About Us


Careers

Blog Archive





        ▼ 
      



2017

(5)





        ▼ 
      



October

(1)

Taiwan Heist: Lazarus Tools and Ransomware








        ► 
      



May

(1)







        ► 
      



April

(1)







        ► 
      



February

(2)








        ▼ 
      



2017

(5)





        ▼ 
      



October

(1)

Taiwan Heist: Lazarus Tools and Ransomware








        ► 
      



May

(1)







        ► 
      



April

(1)







        ► 
      



February

(2)








        ▼ 
      



October

(1)

Taiwan Heist: Lazarus Tools and Ransomware







        ▼ 
      



October

(1)

Taiwan Heist: Lazarus Tools and Ransomware



Taiwan Heist: Lazarus Tools and Ransomware

Taiwan Heist: Lazarus Tools and Ransomware





        ► 
      



May

(1)






        ► 
      



May

(1)






        ► 
      



April

(1)






        ► 
      



April

(1)






        ► 
      



February

(2)






        ► 
      



February

(2)






        ► 
      



2016

(4)





        ► 
      



May

(1)







        ► 
      



April

(2)







        ► 
      



January

(1)








        ► 
      



2016

(4)





        ► 
      



May

(1)







        ► 
      



April

(2)







        ► 
      



January

(1)








        ► 
      



May

(1)






        ► 
      



May

(1)






        ► 
      



April

(2)






        ► 
      



April

(2)






        ► 
      



January

(1)






        ► 
      



January

(1)






        ► 
      



2015

(3)





        ► 
      



December

(1)







        ► 
      



November

(1)







        ► 
      



June

(1)








        ► 
      



2015

(3)





        ► 
      



December

(1)







        ► 
      



November

(1)







        ► 
      



June

(1)








        ► 
      



December

(1)






        ► 
      



December

(1)






        ► 
      



November

(1)






        ► 
      



November

(1)






        ► 
      



June

(1)






        ► 
      



June

(1)






        ► 
      



2013

(3)





        ► 
      



November

(3)








        ► 
      



2013

(3)





        ► 
      



November

(3)








        ► 
      



November

(3)






        ► 
      



November

(3)

Search












Flickr
Labels


Threat Research



Threat Research


Taiwan Heist: Lazarus Tools and Ransomware



#
MD5 
Filenames 
Submitted From
First Seen 
Compile Time


1 
9563e2f443c3b4e1b00f25be0a30d56e 
FEIB_Samples_pwd(Virus).zi_ 
TW 
2017-10-12 02:50:16 
N/A


2 
d08f1211fe0138134e822e31a47ec5d4 
bitsran.exe 
TW 
2017-10-03 01:01:31 
2017-10-01 15:37:31


3 
b27881f59c8d8cc529fa80a58709db36 
RSW7B37.tmp 
- 
2017-10-03 01:01:37 
2017-10-01 11:34:07


4 
3c9e71400b72cc0213c9c3e4ab4df9df 
msmpeng.exe 
US 
2017-10-07 08:58:00 
2017-02-20 11:09:30


5 
0edbad9e6041d43f97c7369439a40138 
FileTokenBroker.dll 
TW 
2017-10-12 02:50:15
2017-01-05 01:11:33


6 
97aaf130cfa251e5207ea74b2558293d 
splwow32.exe 
TW 
2017-10-12 02:50:15
2017-02-20 11:09:30


7 
62217af0299d6e241778adb849fd2823 
N/A 
GB 
2017-10-08 03:32:47 
2017-09-21 09:27:43


8 
0dd7da89b7d1fe97e669f8b4156067c8 
N/A 
MY 
2017-03-14 02:13:01 
2017-03-06 17:32:58


9 
61075faba222f97d3367866793f0907b 
N/A 
MY 
2017-02-16 03:25:00 
2017-02-10 15:03:30




Process Name 
Process Description


tmbmsrv.exe 
Trend Micro Unauthorized Change Prevention Service


tmccsf.exe 
Trend Micro OfficeScan Common Client Solution Framework


cntaosmgr.exe 
Trend Micro OfficeScan Add-on Service Client Management Service


ntrtscan.exe 
Trend Micro OfficeScan NT RealTime Scan


pccntmon.exe 
Trend Micro OfficeScan Antivirus real-time scan monitor


tmlisten.exe 
Trend Micro OfficeScan NT Listener


tmpfw.exe 
Trend Micro OfficeScan NT Firewall




Account Name 
Account Password


FEIB\SPUSER14 
#ED{REMOVED}


FEIB\scomadmin 
!it{REMOVED}



  •  10.49.*
  •  10.50.*
  •  10.51.*
  •  10.59.*

  •  10.49.*
  •  10.50.*
  •  10.51.*
  •  10.59.*

  •  *.VHD
  •  *.bac
  •  *.bak
  •  *.wbcat
  •  *.bkf
  •  Backup*.*
  •  backup*.*
  •  *.set
  •  *.win
  •  *.dsk

  •  *.VHD
  •  *.bac
  •  *.bak
  •  *.wbcat
  •  *.bkf
  •  Backup*.*
  •  backup*.*
  •  *.set
  •  *.win
  •  *.dsk


State/Command 
Translation from Russian 
Meaning


Nachalo 
beginning 
start communication session


ustanavlivat 
to set 
handshake state


poluchit 
to receive 
receive data


pereslat 
to send 
send data


derzhat 
to maintain 
maintain communication session


vykhodit 
to exit 
exit communication session


kliyent2podklyuchit 
client to connect 
client is ready to connect 



  •  Destination beneficiary accounts in Sri Lanka and Cambodia – both countries have been used previously as destinations for Lazarus’ bank heist activity;
  •  
Use of malware previously seen in Lazarus’ Poland and Mexico bank attacks. Where these files were found and the context of their use needs to be confirmed, but could provide a crucial attributive link;
  •  
Use of unusual ransomware, potentially as a distraction.

  •  Destination beneficiary accounts in Sri Lanka and Cambodia – both countries have been used previously as destinations for Lazarus’ bank heist activity;
  •  
Use of malware previously seen in Lazarus’ Poland and Mexico bank attacks. Where these files were found and the context of their use needs to be confirmed, but could provide a crucial attributive link;
  •  
Use of unusual ransomware, potentially as a distraction.

  •  Firewall off SMB (445) for internal computers. If access to this service is required, it should be permitted only for those IP’s that require access. i.e. 445 is required for SCOM to push an agent install, therefore 445 should only be allowed from that source server;
  •  
Application blacklisting should be implemented to prevent the use of tools such as vssadmin.exe, cmd.exe, powershell.exe and similar;
  •  
File Integrity Monitoring should be considered and configured to monitor file creations in “trusted” locations such as the System32 directory. This can also be used to monitor deletes, with an alert configured to fire on excessive deletes in a row;
  •  
Windows Security Event logs should be monitored to capture Scheduled Task creation events – Event ID 4698;
  •  
Registry Auditing should be enabled and monitored to capture any additions toHKLM\Software\Microsoft\Windows\CurrentVersion\Run;
  •  
Excessive use of known administrative privilege accounts should be alerted on – specifically in a “one to many” behavioural configuration. i.e. is one specific IP connecting to a large number of devices using the same credentials in a short period of time;
  •  
Ensure privileged accounts have a complex password that does not include any part of the username, or application it relates to.

  •  Firewall off SMB (445) for internal computers. If access to this service is required, it should be permitted only for those IP’s that require access. i.e. 445 is required for SCOM to push an agent install, therefore 445 should only be allowed from that source server;
  •  
Application blacklisting should be implemented to prevent the use of tools such as vssadmin.exe, cmd.exe, powershell.exe and similar;
  •  
File Integrity Monitoring should be considered and configured to monitor file creations in “trusted” locations such as the System32 directory. This can also be used to monitor deletes, with an alert configured to fire on excessive deletes in a row;
  •  
Windows Security Event logs should be monitored to capture Scheduled Task creation events – Event ID 4698;
  •  
Registry Auditing should be enabled and monitored to capture any additions toHKLM\Software\Microsoft\Windows\CurrentVersion\Run;
  •  
Excessive use of known administrative privilege accounts should be alerted on – specifically in a “one to many” behavioural configuration. i.e. is one specific IP connecting to a large number of devices using the same credentials in a short period of time;
  •  
Ensure privileged accounts have a complex password that does not include any part of the username, or application it relates to.

  •  Practice incident response scenarios which include complex attacks combining covert payment fraud and overt network disruption through ransomware, DDoS, network downtime, etc.
  •  
Ensure that you are progressing towards being able to attest against the SWIFT 27 controls. 

For more information see:

http://www.baesystems.com/en/cybersecurity/swift-customer-security-programme

  •  Practice incident response scenarios which include complex attacks combining covert payment fraud and overt network disruption through ransomware, DDoS, network downtime, etc.
  •  
Ensure that you are progressing towards being able to attest against the SWIFT 27 controls. 

For more information see:

http://www.baesystems.com/en/cybersecurity/swift-customer-security-programme


MD5 Hashes 
d08f1211fe0138134e822e31a47ec5d4



b27881f59c8d8cc529fa80a58709db36



3c9e71400b72cc0213c9c3e4ab4df9df



0edbad9e6041d43f97c7369439a40138



97aaf130cfa251e5207ea74b2558293d



62217af0299d6e241778adb849fd2823



0dd7da89b7d1fe97e669f8b4156067c8



61075faba222f97d3367866793f0907b


File / Process name  
bitsran.exe 


No comments:


Post a Comment



SUBSCRIBE
Sign up to receive our regular Cyber Threat Bulletin.
Popular Posts








Two bytes to $951m










WanaCrypt0r Ransomworm










Cyber Heist Attribution











Two bytes to $951m










WanaCrypt0r Ransomworm










Cyber Heist Attribution



Contact
For further information or to talk to an expert, please contact us.

































Accessibility
Terms & conditions
Privacy
Sitemap

Accessibility
Terms & conditions
Privacy
Sitemap
© 2015 BAE Systems. All rights reserved
