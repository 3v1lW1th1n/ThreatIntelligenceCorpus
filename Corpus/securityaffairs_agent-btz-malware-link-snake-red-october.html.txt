
					Is the Agent.btz malware the link between Snake and Red October?					
In the last weeks we have discussed about the Snake platform used in a large-scale cyber espionage campaign that targeted highly secured systems belonging to Governments and Military all over the world. Experts at BAE Systems Applied Intelligence, who discovered the Snake campaign, have linked the platform to the Uroburos rootkit, another malware used for the same purpose and discovered by the German firm G Data. Researchers at BAE also discovered another piece of malware named Turla, their opinion is that the malicious code was developed by a Russian cyber specialists, probably all these instances are part of a cyber weapon program of the Government of Moscow.
The Snake cyber espionage campaign remained undetected for a log time, at least for eight years, the researchers also found a link to older pieces of malware Agent.btz, a worm which infected US military networks several years ago. According Kaspersky, Lab the Agent.btz was discovered on nearly 13,800 systems across 100 countries in 2013.

Turla seems to have been designed by Russian-speaking authors, exactly like the predecessor Agent.btz and the malicious code used for the Red October cyber espionage campaign. Researchers discovered that Turla uses the same XOR key and log file names as Agent.btz, but we have to consider that it could be a diversionary strategy of the malware authors. 
The details of the Agent.btz agent have been known publicly for a long ago, many reports provide information regarding the name of the files used, including the specific log file names, and even the XOR key.
“The connection between Turla and Agent.btz is more direct, although not sufficiently so to conclude that the two programs have the same origin. Turla uses the same file names as Agent.btz – “mswmpdat.tlb”, “winview.ocx” and “wmcache.nld” for its log files stored on infected systems.”  said Aleks Gostev, Chief Security Expert at Kaspersky Lab
Resuming both Turla and Agent.btz have files with identical names, but the surprise is the presence of a file called “thumb.dd” present in both Turla and Red October malware.
“We cannot make such a conclusion based only on the listed facts”,“All the information used by developers was publicly known – at least by the time of Red October and Gauss/Flame creation. First of all, it wasn’t a secret that Agent.btz used ‘thumb.dd’ as a container file to collect information about infected systems. ” “Secondly, the XOR key used by developers of Turla and Agent.btz to encrypt their log files was also published in 2008. It’s unknown since when this key was first used in Turla, but we see it for sure in the latest samples of the malware (created in 2013-2014). At the same time, there is some data that Turla’s development started in 2006 – before any known sample of Agent.btz. Which leaves the question open.” has written Gostev.
According researchers at Kaspersky Lab, who uncovered the Red October, it’s possible the malicious code used for the campaign was designed to scan for the “thumb.dd” file on the victim in order to steal the data contained in the file.
Gostev remarked that there also are some similarities between the Flame, Gauss and the Agent. btz, but this circumstance could be a consequence of the fact that the authors of Flame and Gauss have had access to the analysis of Agent.btz.
“Summarizing all the above, it is possible to regard Agent.btz as a certain starting point in the chain of creation of several different cyber-espionage projects. The well-publicized story of how US military networks were infected could have served as the model for new espionage programs having similar objectives, while its technologies were clearly studied in great detail by all interested parties. Were the people behind all these programs all the same? It’s possible, but the facts can’t prove it,” Gostev reported in the analysis he conducted.
Let me suggest the reading of an interesting report on the Agent.btz published by Sergey Shevchenko.
Pierluigi Paganini
(Security Affairs – Agent.btz, Red October malware)
