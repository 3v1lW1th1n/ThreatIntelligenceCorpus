Trouble brewing as iThing coffee machine seems to be hackable
The same team of security researchers who discovered that the Wi-Fi iKettle from Smarter blurted out wireless network credentials have found cause for concern over a Wi-Fi Coffee Machine, and iKettle 2.0, from the same manufacturer.


Pen Test Partners mapped and hacked insecure connected iKettles across London, proving they can leak Wi-Fi passwords, as previously reported.
Things have improved with the Wi-Fi Coffee Machine from Smarter (which is passionate about "tea, coffee and technology", according to its website) but not to the extent that it’s completely secure, according to preliminary findings from Pen Test Partners' research.
On the plus side the mobile app has had a significant update and the “ridiculous static/short PIN bug doesn’t appear to be present", Pen security researchers reported.
However, the unconfigured coffee machine, at least, is hackable, according to preliminary results from ongoing research from the UK-based security consultancy.
Prior to being hooked up to the mobile app, the unconfigured coffee machine works as a Wi-Fi access point. The iKettle, for comparison, operates as an ad-hoc Wi-Fi device.
The iKettle communicates on TCP ports 23 and 2000 but the coffee machine is silent on those ports, something that might be explained by the use of a different Wi-Fi module from the VSD03 as found in the iKettle.
The Wi-Fi Coffee Machine chats on TCP & UDP port 2081 instead, using what appears to be a simple binary protocol, the security researchers discovered.
The device broadcast a status message every five seconds which contains details about the iThing’s status, including the fill level on the water reservoir, number of cups, and coffee strength.
Somewhat like the iKettle, the Wi-Fi Coffee Machine is designed to save users precious seconds waiting for coffee to brew by allowing the device to be operated using a smartphone app.
Pen Test Partners looked at the traffic generated by the coffee machine, using the mobile app for clues before fuzzing the protocol. This allowed them to discover that the Wi-Fi module in use is the ESP8266, based on the command set in play.
Knowing the Wi-Fi module being used allowed Pen Test Partners to use the coffee machine to discover Wi-Fi networks. This isn’t a big issue by itself but the idea of Wi-Fi stumbling by coffee machine was sufficiently offbeat to amuse the security researchers.
What is of concern is that hackers in geographical proximity to a device might be able to drive past a user’s house and take control of their coffee machine and start it brewing, as a blog post by Pen Test Partners illustrates.
Whilst the user is out, if they haven’t configured the Wi-Fi on their coffee machine, we can have it brew to order. Nasty stale coffee anyone? Empty water container? All the coffee grounds used?
It’s also a trivial matter to remotely force the Wi-Fi Coffee Machine into upgrading its firmware, making the machine temporarily unavailable in the process. Triggering a firmware upgrade has the effect of factory resetting the Wi-Fi module, at minimum creating a confusing nuisance for users.
Without a hard reset (user holds down ‘start’ button for 10 secs) the Wi-Fi module won’t operate, according to Pen Test Partners.
But a separate (as yet undiscovered) hack would be needed to change what software is actually download as part of the firmware upgrade, something that might be used to trick the iThing into running rogue firmware code developed by hackers. Pen Test Partners is in the process of investigating the firmware upgrade process to look for possible holes.
Configured coffee machines do not exhibit the same set of risks, according to Ken Munro, a director at Pen Test Partners.
“The issue is that we’ve currently only got a vulnerability in an unconfigured coffee machine,” Munro told El Reg. “It’s a legitimate attack, but not the killer Wi-Fi PSK theft that we had with the iKettle ... yet.”
“Plenty of attack vectors to investigate, but we need more time,” he added. ®

Sponsored: 
Following Bottomline’s journey to the Hybrid Cloud

