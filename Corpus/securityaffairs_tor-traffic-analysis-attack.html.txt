
					81 percent of Tor clients can be identified with traffic analysis attack					
A team of researchers conducted a study between 2008 and 2014 on the de-anonymization of the Tor users, the team worked to disclose their originating IP addresses.
A group led by professor Sambuddho Chakravarty, now researching Network Anonymity and Privacy at the Indraprastha Institute of Information Technology in Delhi, has published numerous papers on the topic over the last years.  Chakravarty claims that his team has reached a 100 percent ‘decloaking’ success rate under laboratory conditions.
The research revealed that more than 81 percent of Tor clients can be de-anonymized by exploiting the Netflow technology designed by Cisco for its network appliances.
The Netflow technology was introduced by Cisco into its routers to implement an instrument to collect IP network traffic as it enters or exits an interface. The data provided by NetFlow allows a network administrator to qualify the network traffic managed by the router and identify the causes of congestion. The protocol is a standard de facto and it runs today by default in the hardware of many other network device manufacturers.
The technique proposed by Chakravarty implements an active traffic analysis based on the introduction of specific traffic perturbations on server side and evaluating a similar perturbation on the client side through statistical correlation.
“We present an active traffic analysis method based on deliberately perturbing the characteristics of user traffic at the server side, and observing a similar perturbation at the client side through statistical correlation. We evaluate the accuracy of our method using both in-lab testing, as well as data gathered from a public Tor relay serving hundreds of users. Our method revealed the actual sources of anonymous traffic with 100% accuracy for the in-lab tests, and achieved an overall accuracy of about 81.4% for the real-world experiments, with an average false positive rate of 6.4.” states the paper.
In a previous research, Chakravarty demonstrated that having access to a few Internet exchange points is enough for monitoring a signiﬁcant percentage of the network paths from Tor nodes to destination servers. This means that a powerful and persistent attacker can run trafﬁc analysis attacks by observing similar trafﬁc patterns at various points of the network.
This new research exploits reveals how to run an effective traffic analysis attack with less trafﬁc monitoring capabilities, such as Cisco’s NetFlow,to run a trafﬁc analysis attack on a large scale.
Unlike previous research, this new traffic analysis attack would not necessarily need the resources of a Government to run the monitoring activity, the researcher explained that a single AS (Autonomous System) could monitor more than 39 percent of randomly-generated Tor circuits.
A traffic analysis attack doesn’t request the enormous infrastructural effort than the previous technique, but it exploits one or more high-bandwidth and high-performance Tor relays. The team used a modified public Tor server, hosted at the time at Columbia University, running on Linux for its tests.

The researchers simulate the internet activity of a typical Tor user, they injected a repeating traffic pattern (i.e. HTML files) into the TCP connection that it sees originating in the target exit node, and then analyzed the traffic at exit node, as derived from the router’s flow records, to improve client identification.

 
In a first phase the research was conducted in Lab environment with surprising results, in a second phase, the team started the live sessions using real Tor trafﬁc. The team analyzed the traffic obtained from its public Tor relay that served hundreds of Tor circuits simultaneously.
The targeted victims were hosted on three different locations on the Planetlab, the global research network that supports the development of new network services. The chosen locations are Texas (US), Leuven (Belgium) and Corfu (Greece).
The victim clients downloaded a large ﬁle from the server that deliberately introduced perturbations in the arriving TCP connection’s trafﬁc, thereby deliberately injecting a trafﬁc pattern in the stream between the server and the exit node.
“The process was terminated after a short while and we computed the correlation between the bytes transferred between the server and the recently terminated connection from the exit node and the entry node and the several clients that used it, during this interval.” states the paper.
The test session was organized in two parts, a first session to evaluate the effectiveness when retrieving data from open-source NetFlow packages, in the second round  the team used sparse data obtained from its institutional Cisco router.

De-anonymization of Tor users is a primary goal for law enforcement and intelligence agencies, that having great computational resources are able to run similar attacks. Many experts speculate that also the recent Operation Onymous that allowed the seizure of several dark market places, including the popular Silk Road 2.0, may have exploited a traffic analysis attack against Tor network to identify the operators of the black markets.
 
Pierluigi Paganini
(Security Affairs –  Tor Traffic Analysis Attack, hacking)
