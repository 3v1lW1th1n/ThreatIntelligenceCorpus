
Windows Auto Start Locations


Hi Folks, this weekend I've been involved in a interesting Windows Forensic Analysis Process. There are lots of Forensic Analysis tools around here (just ask google to see a couple of that), but in some scenarios, like for example scenarios where you wont shutdown the machine, you might find some troubles to install new security tools because some malware make it impossible.In these and other situations is still useful knowing where Auto Start Locations are in Windows XP and Windows VISTA (I dunno yet Windows 7, and for older Windows these location might be different).Reading different blogs, forum and some good book, I learned some interesting places where find out malware and viruses,and today I wanna point out these interesting places where the penetrator should investigate. I don't think the following list complete, but anyway... stay tuned for more upgrades.Some useful variables to make the list shorter:HKLM : HKEY_LOCAL_MACHINEHKCU : HKEY_CURRENT_USERHKCR : HKEY_CLASSES_ROOT%windir% : The Windows Directory. Can be C:Windows or C:WINNT or anything, depending on the location, the OS & the customization of the OS!%USERPROFILE% : Normally is C:Documents and Settings, depending on the installation location.%ALLUSERSPROFILE% : Normally is C:Documents and SettingsAll Users, depending on the installation location.Register locations:1. HKLMSystemCurrentControlSetControlTerminal ServerWdsrdpwdStartupPrograms2. HKLMSOFTWAREMicrosoftWindows NTCurrentVersionWinlogonAppSetup3. HKLMSoftwarePoliciesMicrosoftWindowsSystemScriptsStartup4. HKCUSoftwarePoliciesMicrosoftWindowsSystemScriptsLogon5. HKLMSoftwarePoliciesMicrosoftWindowsSystemScriptsLogon6. HKLMSOFTWAREMicrosoftWindows NTCurrentVersionWinlogonUserinit7. HKCUSoftwareMicrosoftWindowsCurrentVersionPoliciesSystemShell8. HKCUSOFTWAREMicrosoftWindows NTCurrentVersionWinlogonShell9. HKLMSoftwareMicrosoftWindowsCurrentVersionPoliciesSystemShell10. HKLMSOFTWAREMicrosoftWindows NTCurrentVersionWinlogonShell11. HKLMSOFTWAREMicrosoftWindows NTCurrentVersionWinlogonTaskman12. HKLMSOFTWAREMicrosoftWindows NTCurrentVersionTerminal ServerInstallSoftwareMicrosoftWindowsCurrentVersionRunonce13. HKLMSOFTWAREMicrosoftWindows NTCurrentVersionTerminal ServerInstallSoftwareMicrosoftWindowsCurrentVersionRunonceEx14. HKLMSOFTWAREMicrosoftWindows NTCurrentVersionTerminal ServerInstallSoftwareMicrosoftWindowsCurrentVersionRun15. HKLMSOFTWAREMicrosoftWindowsCurrentVersionRun16. HKLMSOFTWAREMicrosoftWindowsCurrentVersionRunOnceEx17. HKLMSOFTWAREMicrosoftWindowsCurrentVersionRunOnce18. HKCUSoftwareMicrosoftWindows NTCurrentVersionWindowsLoad19. HKCUSoftwareMicrosoftWindows NTCurrentVersionWindowsRun20. HKLMSOFTWAREMicrosoftWindowsCurrentVersionPoliciesExplorerRun21. HKCUSoftwareMicrosoftWindowsCurrentVersionPoliciesExplorerRun22. HKCUSoftwareMicrosoftWindowsCurrentVersionRun23. HKCUSoftwareMicrosoftWindowsCurrentVersionRunOnce24. HKCUSoftwareMicrosoftWindowsCurrentVersionRunOnceSetup25. HKCUSOFTWAREMicrosoftWindows NTCurrentVersionTerminalServerInstallSoftwareMicrosoftWindowsCurrentVersionRunonce26. HKCUSOFTWAREMicrosoftWindows NTCurrentVersionTerminal ServerInstallSoftwareMicrosoftWindowsCurrentVersionRunonceEx27. HKCUSOFTWAREMicrosoftWindows NTCurrentVersionTerminal ServerInstallSoftwareMicrosoftWindowsCurrentVersionRun28. HKLMSOFTWAREClassesProtocolsFilter29. HKLMSOFTWAREClassesProtocolsHandler30. HKCUSOFTWAREMicrosoftInternet ExplorerDesktopComponents31. HKLMSOFTWAREMicrosoftActive SetupInstalled Components32. HKCUSOFTWAREMicrosoftActive SetupInstalled Components33. HKLMSOFTWAREMicrosoftWindowsCurrentVersionExplorerSharedTaskScheduler34. HKLMSOFTWAREMicrosoftWindowsCurrentVersionShellServiceObjectDelayLoad35. HKCUSOFTWAREMicrosoftWindowsCurrentVersionShellServiceObjectDelayLoad36. HKLMSoftwareMicrosoftWindowsCurrentVersionExplorerShellExecuteHooks37. HKCUSoftwareClasses*ShellExContextMenuHandlers38. HKLMSoftwareClasses*ShellExContextMenuHandlers39. HKCUSoftwareClassesAllFileSystemObjectsShellExContextMenuHandlers40. HKLMSoftwareClassesAllFileSystemObjectsShellExContextMenuHandlers41. HKCUSoftwareClassesFolderShellExContextMenuHandlers42. HKLMSoftwareClassesFolderShellExContextMenuHandlers43. HKCUSoftwareClassesDirectoryShellExContextMenuHandlers44. HKLMSoftwareClassesDirectoryShellExContextMenuHandlers45. HKCUSoftwareClassesDirectoryBackgroundShellExContextMenuHandlers46. HKLMSoftwareClassesDirectoryBackgroundShellExContextMenuHandlers47. HKCUSoftwareClassesFolderShellexColumnHandlers48. HKLMSoftwareClassesFolderShellexColumnHandlers49. HKCUSoftwareMicrosoftWindowsCurrentVersionExplorerShellIconOverlayIdentifiers50. HKLMSoftwareMicrosoftWindowsCurrentVersionExplorerShellIconOverlayIdentifiers51. HKCUSoftwareMicrosoftCtfLangBarAddin52. HKLMSoftwareMicrosoftCtfLangBarAddin53. HKCUSoftwareMicrosoftWindowsCurrentVersionShell ExtensionsApproved54. HKLMSoftwareMicrosoftWindowsCurrentVersionShell ExtensionsApproved55. HKLMSoftwareMicrosoftWindowsCurrentVersionExplorerBrowser Helper Objects56. HKCUSoftwareMicrosoftInternet ExplorerUrlSearchHooks57. HKLMSoftwareMicrosoftInternet ExplorerToolbar58. HKCUSoftwareMicrosoftInternet ExplorerExplorer Bars59. HKLMSoftwareMicrosoftInternet ExplorerExplorer Bars60. HKCUSoftwareMicrosoftInternet ExplorerExtensions61. HKLMSoftwareMicrosoftInternet ExplorerExtensions62. HKLMSystemCurrentControlSetServices63. HKLMSystemCurrentControlSetServices64. HKLMSystemCurrentControlSetControlSession ManagerBootExecute65. HKLMSystemCurrentControlSetControlSession ManagerSetupExecute66. HKLMSystemCurrentControlSetControlSession ManagerExecute67. HKLMSoftwareMicrosoftWindows NTCurrentVersionImage File Execution Options68. HKLMSoftwareMicrosoftCommand ProcessorAutorun69. HKCUSoftwareMicrosoftCommand ProcessorAutorun70. HKLMSOFTWAREClassesExefileShellOpenCommand(Default)71. HKLMSOFTWAREMicrosoftWindows NTCurrentVersionWindowsAppinit_Dlls72. HKLMSystemCurrentControlSetControlSession ManagerKnownDlls73. HKLMSOFTWAREMicrosoftWindows NTCurrentVersionWinlogonSystem74. HKLMSOFTWAREMicrosoftWindows NTCurrentVersionWinlogonUIHost75. HKLMSOFTWAREMicrosoftWindows NTCurrentVersionWinlogonNotify76. HKLMSOFTWAREMicrosoftWindows NTCurrentVersionWinlogonGinaDLL77. HKCUControl PanelDesktopScrnsave.exe78. HKLMSystemCurrentControlSetControlBootVerificationProgramImagePath79. HKLMSystemCurrentControlSetServicesWinSock2ParametersProtocol_Catalog980. HKLMSYSTEMCurrentControlSetControlPrintMonitors81. HKLMSYSTEMCurrentControlSetControlSecurityProvidersSecurityProviders82. HKLMSYSTEMCurrentControlSetControlLsaAuthentication Packages83. HKLMSYSTEMCurrentControlSetControlLsaNotification Packages84. HKLMSYSTEMCurrentControlSetControlLsaSecurity Packages85. HKLMSYSTEMCurrentControlSetControlNetworkProviderOrder86. HKCUSoftwareMicrosoftWindows NTCurrentVersionWindowsload87. HKCRbatfileshellopencommand @=""%1" %*"88. HKCRcomfileshellopencommand @=""%1" %*"89. HKCRexefileshellopencommand @=""%1" %*"90. HKCRhtafileShellOpenCommand @=""%1" %*"91. HKCRpiffileshellopencommand @=""%1" %*"92. HKLMSoftwareClassesbatfileshellopencommand93. HKLMSoftwareClassescomfileshellopencommand94. HKLMSoftwareClassesexefileshellopencommand95. HKLMSoftwareClasseshtafileshellopencommand96. HKLMSoftwareClassespiffileshellopencommand97. HKLMSystemCurrentControlSetControlClass{4D36E96B-E325-11CE-BFC1-08002BE10318}UpperFilters98. HKLMSoftwareMicrosoftWindows NTCurrentVersionWinlogonVmApplet99. HKLMSoftwareMicrosoftWindows NTCurrentVersionInitFileMapping100. HKLMSoftwareMicrosoftWindows NTCurrentVersionAedebug101. HKLMSoftwareClassesCLSID{CLSID}Implemented Categories{00021493-0000-0000-C000-000000000046}102. HKLMSoftwareClassesCLSID{CLSID}Implemented Categories{00021494-0000-0000-C000-000000000046}103. HKCUSoftwareMicrosoftWindowsCurrentVersionExplorerFileExts.batApplication104. HKCUSoftwareMicrosoftWindowsCurrentVersionExplorerFileExts.cmdApplication105. HKCUSoftwareMicrosoftWindowsCurrentVersionExplorerFileExts.comApplication106. HKCUSoftwareMicrosoftWindowsCurrentVersionExplorerFileExts.exeApplication107. HKCUSoftwareMicrosoftWindowsCurrentVersionExplorerFileExts.htaApplication108. HKCUSoftwareMicrosoftWindowsCurrentVersionExplorerFileExts.pifApplication109. HKCUSoftwareMicrosoftWindowsCurrentVersionExplorerFileExts.scrApplication110. HKCUSoftwareMicrosoftWindowsCurrentVersionExplorerFileExts.batProgID111. HKCUSoftwareMicrosoftWindowsCurrentVersionExplorerFileExts.cmdProgID112. HKCUSoftwareMicrosoftWindowsCurrentVersionExplorerFileExts.comProgID113. HKCUSoftwareMicrosoftWindowsCurrentVersionExplorerFileExts.exeProgID114. HKCUSoftwareMicrosoftWindowsCurrentVersionExplorerFileExts.htaProgID115. HKCUSoftwareMicrosoftWindowsCurrentVersionExplorerFileExts.pifProgID116. HKCUSoftwareMicrosoftWindowsCurrentVersionExplorerFileExts.scrProgID117. HKLMSoftwareCLASSESbatfileshellopencommand @=""%1" %*"118. HKLMSoftwareCLASSEScomfileshellopencommand @=""%1" %*"119. HKLMSoftwareCLASSESexefileshellopencommand @=""%1" %*"120. HKLMSoftwareCLASSEShtafileShellOpenCommand @=""%1" %*"121. HKLMSoftwareCLASSESpiffileshellopencommand @=""%1" %*"122. HKCRvbsfileshellopencommand123. HKCRvbefileshellopencommand124. HKCRjsfileshellopencommand125. HKCRjsefileshellopencommand126. HKCRwshfileshellopencommand127. HKCRwsffileshellopencommand128. HKCRscrfileshellopencommand129. HKLMSoftwareMicrosoftActive SetupInstalled ComponentsKeyNameStubPath=C:PathToFileFilename.exeFolders Locations1. %ALLUSERSPROFILE%Start MenuProgramsStartup2. %USERPROFILE%Start MenuProgramsStartup3. %windir%Tasks4. %windir%System32Tasks - Windows Vista5. %ALLUSERSPROFILE%MicrosoftWindowsStart MenuProgramsStartup6. %USERPROFILE%AppDataRoamingMicrosoftWindowsStart MenuProgramsStartup


