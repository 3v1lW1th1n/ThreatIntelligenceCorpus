PrivDog Poses Bigger Risk Than Superfish
Update Move over Superfish. Another piece of software has been thrust into the spotlight that also breaks HTTPS connections, but is arguably worse than Superfish, which was pre-installed adware on new Lenovo laptops manufactured at the tail end of 2014.
Researcher Hanno Bock yesterday reported that PrivDog, like Superfish, installs its own certificate and breaks SSL connections by creating a man-in-the-middle vulnerability that can be exploited by anyone to sniff traffic. Bock said, however, that while PrivDog doesn’t contain the exact vulnerability as Superfish, it likely presents a bigger mess for users.
PrivDog was developed by Comodo founder and CEO Melih Abdulhayoglu. PrivDog is bundled with one of Comodo’s flagship products, Comodo Internet Security, but only as a browser extension. Only the standalone version is vulnerable.
“PrivDog will intercept every certificate and replace it with one signed by its root key. And that means also certificates that weren’t valid in the first place,” Bock said. “It will turn your browser into one that just accepts every HTTPS certificate out there, whether it’s been signed by a certificate authority or not. We’re still trying to figure out the details, but it looks pretty bad.”
Superfish, which uses a library that does SSL interception called Komodia SSL Digester, ships with the same digital certificate and encryption key in every installation. Komodia’s website is today still under a distributed denial-of-service attack as of 10 a.m. Eastern time. Researcher Rob Graham of Errata Security reported on Thursday, hours after the Superfish vulnerability was disclosed, that he was able to extract the private key protecting the certificate.
Bock said PrivDog’s behavior is different; the latest version of PrivDog, 3.0.96.0 carries the vulnerability and is available as a standalone program. Previously, it was available only as a browser extension and bundled with Comodo Internet Security. The extension, Bock said, is not directly vulnerable. A PrivDog advisory published yesterday called the vulnerability a “minor intermittent defect” affecting a “very small number of users.” The organization said 57,000 users globally are exposed, 6,300 in the United States.
“In some circumstances self-signed certificates do not trigger a browser warning but encryption is still provided to the end user, hence security via encryption remains intact,” the PrivDog advisory said, adding that an update is available in version 3.0.105.0. “The potential issue is only present if a user visits a site that actually has a self-signed certificate.”
PrivDog, like Superfish, installs its own certificate and breaks SSL connections. via @Threatpost
The Department of Homeland Security-sponsored CERT at the Software Engineering Institute at Carnegie Mellon University yesterday issued an advisory warning users of the vulnerability. The man-in-the-middle capabilities in PrivDog are supplied by NetFilterSDK, DHS said.
“Although the root CA certificate is generated at install time, resulting in a different certificate for each installation, Privdog does not use the SSL certificate validation capabilities that the NetFilter SDK provides,” the DHS advisory said. “This means that web browsers will not display any warnings when a spoofed or MITM-proxied HTTPS website is visited.”
As for Superfish, it has already been discovered in more than a dozen other applications. Researchers at Facebook’s Security Team yesterday published a report that said the applications are all on VirusTotal with their associated malicious Komodia libraries.
“We can’t say for certain what the intentions of these applications are, but none appear to explain why they intercept SSL traffic or what they do with the data,” said Matt Richard, a threats researcher at Facebook. Richard also published a list of certificate issuers, and said the list represents certs on more than 1,000 systems on applications that include games and pop-up generators.
Lenovo chief technology officer Peter Hortensius, meanwhile, yesterday apologized in an open letter to his customers. Superfish began shipping pre-installed on Lenovo machines last September and almost immediately, customers began complaining about its behavior. Hortensius said Lenovo will no longer ship with Superfish and provided a manual fix within hours of the vulnerability disclosure, followed by an automated patch last Friday. It also worked with Microsoft and several security partners to disable and remove Superfish from machines.
That, however, hasn’t stopped some users from taking legal action against Lenovo. The Rosen Law Firm of New York said it initiated a class-action investigation against Lenovo and urged anyone who bought a Lenovo computer between September 2014 and January 2015 to contact the firm and participate in a potential lawsuit.
This article was updated to correct references to PrivDog as adware.
